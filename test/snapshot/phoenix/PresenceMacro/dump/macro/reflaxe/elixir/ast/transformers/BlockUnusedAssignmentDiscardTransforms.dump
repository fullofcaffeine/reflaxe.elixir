class reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms {

	public static function pass(ast:reflaxe.elixir.ast.ElixirAST) {
		return reflaxe.elixir.ast.ElixirASTTransformer.transformNode(ast, function(n:reflaxe.elixir.ast.ElixirAST) {
			return @:ast(switch (n.def) {
	case EModule(name, attrs, body) if (looksLikePresenceModule(name, n)):
		n;	
	case EDefmodule(name, doBlock) if (looksLikePresenceModule(name, n)):
		n;	
	case EDef(name, args, guards, body):
		var nb = rewriteBody(body, name == "changeset");
		makeASTWithMeta(EDef(name, args, guards, nb), n.metadata, n.pos);	
	case EBlock(_):
		rewriteBody(n);	
	case EDo(_):
		rewriteBody(n);	
	case EIf(cond, then_, else_):
		var newThen = rewriteBody(then_);
		var newElse = else_ != null ? rewriteBody(else_) : null;
		makeASTWithMeta(EIf(cond, newThen, newElse), n.metadata, n.pos);	
	case ECase(expr, clauses):
		var newClauses:Array<ECaseClause> = [];
		for (cl  in  clauses) newClauses.push({ pattern : cl.pattern, guard : cl.guard, body : rewriteBody(cl.body) });
		makeASTWithMeta(ECase(expr, newClauses), n.metadata, n.pos);	
	case EFn(clauses):
		var newClauses = [];
		for (cl  in  clauses) {
			var b = cl.body;
			newClauses.push({ args : cl.args, guard : cl.guard, body : rewriteBody(b) });
		};
		makeASTWithMeta(EFn(newClauses), n.metadata, n.pos);	
	default:
		n;	
}) {
				var ` = n.def;
				switch (enumIndex `) {
					case 0: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var name = `;
							var attrs = `;
							var body = `;
							if (if (n != null && n.metadata != null && n.metadata.isPresence == true) {
								true;
							} else {
								if (name == null) {
									false;
								} else {
									StringTools.endsWith(name, ".Presence") || StringTools.endsWith(name, "Web.Presence");
								};
							}) {
								n;
							} else {
								n;
							};
						};
					};
					case 1: {
						var ` = `[0];
						var ` = `[1];
						{
							var name = `;
							var doBlock = `;
							if (if (n != null && n.metadata != null && n.metadata.isPresence == true) {
								true;
							} else {
								if (name == null) {
									false;
								} else {
									StringTools.endsWith(name, ".Presence") || StringTools.endsWith(name, "Web.Presence");
								};
							}) {
								n;
							} else {
								n;
							};
						};
					};
					case 2: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						var ` = `[3];
						{
							var name = `;
							var args = `;
							var guards = `;
							var body = `;
							{
								var nb = reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rewriteBody(body, name == "changeset");
								{def : reflaxe.elixir.ast.ElixirASTDef.EDef(name, args, guards, nb), metadata : n.metadata, pos : n.pos};
							};
						};
					};
					case 6: {
						var ` = `[0];
						var ` = `[1];
						{
							var expr = `;
							var clauses = `;
							{
								var newClauses = [];
								{
									var ` = 0;
									while (` < clauses.length) {
										var cl = clauses[`];
										++ `;
										newClauses.push({pattern : cl.pattern, guard : cl.guard, body : reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rewriteBody(cl.body, null)});
									};
								};
								{def : reflaxe.elixir.ast.ElixirASTDef.ECase(expr, newClauses), metadata : n.metadata, pos : n.pos};
							};
						};
					};
					case 10: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var cond = `;
							var then_ = `;
							var else_ = `;
							{
								var newThen = reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rewriteBody(then_, null);
								var newElse = if (else_ != null) {
									reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rewriteBody(else_, null);
								} else {
									null;
								};
								{def : reflaxe.elixir.ast.ElixirASTDef.EIf(cond, newThen, newElse), metadata : n.metadata, pos : n.pos};
							};
						};
					};
					case 42: {
						var ` = `[0];
						{
							var clauses = `;
							{
								var newClauses = [];
								{
									var ` = 0;
									while (` < clauses.length) {
										var cl = clauses[`];
										++ `;
										var b = cl.body;
										newClauses.push({args : cl.args, guard : cl.guard, body : reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rewriteBody(b, null)});
									};
								};
								{def : reflaxe.elixir.ast.ElixirASTDef.EFn(newClauses), metadata : n.metadata, pos : n.pos};
							};
						};
					};
					case 53: {
						var ` = `[0];
						{
							reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rewriteBody(n, null);
						};
					};
					case 55: {
						var ` = `[0];
						{
							reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rewriteBody(n, null);
						};
					};
					default: {
						n;
					}
				};
			};
		});
	}

	static inline function looksLikePresenceModule(name:String, node:reflaxe.elixir.ast.ElixirAST) {
		if (node != null && node.metadata != null && node.metadata.isPresence == true) {
			return true;
		};
		if (name == null) {
			return false;
		};
		return StringTools.endsWith(name, ".Presence") || StringTools.endsWith(name, "Web.Presence");
	}

	@:value({ inChangeset : false })
	static function rewriteBody(body:reflaxe.elixir.ast.ElixirAST, inChangeset:Null<Bool> = false) {
		return @:ast(switch (body.def) {
	case EBlock(stmts):
		var out:Array<ElixirAST> = [];
		function hasHeexFrom(start:Int):Bool {
			var found = false;
			for (k  in  start ... stmts.length) {
				switch (stmts[k].def) {
					case ESigil(type, _, _) if (type == "H"):
						found = true;					
					case ERaw(code) if (code != null && code.indexOf("~H\"") != -1):
						found = true;					
					default:
				};
				if (found) break;
			};
			return found;
		};
		function interpolationReferencesFrom(start:Int, name:String):Bool {
			var hit = false;
			if (name == null || name.length == 0) return false;
			for (k  in  start ... stmts.length) {
				switch (stmts[k].def) {
					case EString(s) if (s != null && s.indexOf("#{") != -1 && s.indexOf(name) != -1):
						hit = true;					
					case ERaw(code) if (code != null && code.indexOf("#{") != -1 && code.indexOf(name) != -1):
						hit = true;					
					default:
				};
				if (hit) break;
			};
			return hit;
		};
		for (i  in  0 ... stmts.length) {
			var s = stmts[i];
			switch (s.def) {
				case EBinary(Match, left, rhs):
					switch (left.def) {
						case EVar(nm):
							if (nm == "children") {
								out.push(s);
								break;
							};
							if (nm == "assigns") {
								out.push(s);
								break;
							};
							if (isPresenceEffectCall(rhs) || isLogTraceCall(rhs)) {
								out.push(s);
								break;
							};
							if (nm == "query" && filterPredicateUsesQueryLater(stmts, i + 1)) {
								out.push(s);
							} else if (isDowncaseSearch(rhs)) {
								out.push(s);
							} else if (!(inChangeset && rhsContainsChangesetCall(rhs)) && !VarUseAnalyzer.usedLater(stmts, i + 1, nm) && !rawIdentifierUsedLater(stmts, i + 1, nm) && !exprReferencesName(rhs, nm) && !hasPinnedVarInEctoWhere(stmts, i + 1, nm, s.metadata != null ? s.metadata.varId : null) && !repoCallUsesVarLater(stmts, i + 1, nm) && !hasPinnedVarInBlock(stmts, i + 1, nm) && !interpolationReferencesFrom(i + 1, nm) && (nm.length > 0 && nm.charAt(0) == "_") && !(nm.length > 1 && (interpolationReferencesFrom(i + 1, nm.substr(1)) || rawIdentifierUsedLater(stmts, i + 1, nm.substr(1))))) {
								out.push(makeASTWithMeta(EMatch(PWildcard, rhs), s.metadata, s.pos));
							} else out.push(s);						
						default:
							out.push(s);						
					};				
				case EMatch(pat, rhs2):
					switch (pat) {
						case PVar(nm2):
							if (nm2 == "children") {
								out.push(s);
								break;
							};
							if (nm2 == "assigns") {
								out.push(s);
								break;
							};
							if (isPresenceEffectCall(rhs2) || isLogTraceCall(rhs2)) {
								out.push(s);
								break;
							};
							if (isDowncaseSearch(rhs2)) {
								out.push(s);
							} else if (!(inChangeset && rhsContainsChangesetCall(rhs2)) && !VarUseAnalyzer.usedLater(stmts, i + 1, nm2) && !rawIdentifierUsedLater(stmts, i + 1, nm2) && !exprReferencesName(rhs2, nm2) && !hasPinnedVarInEctoWhere(stmts, i + 1, nm2, s.metadata != null ? s.metadata.varId : null) && !repoCallUsesVarLater(stmts, i + 1, nm2) && !hasPinnedVarInBlock(stmts, i + 1, nm2) && !interpolationReferencesFrom(i + 1, nm2) && (nm2.length > 0 && nm2.charAt(0) == "_") && !(nm2.length > 1 && (interpolationReferencesFrom(i + 1, nm2.substr(1)) || rawIdentifierUsedLater(stmts, i + 1, nm2.substr(1))))) {
								out.push(makeASTWithMeta(EMatch(PWildcard, rhs2), s.metadata, s.pos));
							} else out.push(s);						
						default:
							out.push(s);						
					};				
				default:
					out.push(s);				
			};
		};
		makeASTWithMeta(EBlock(out), body.metadata, body.pos);	
	case EDo(stmts2):
		var out2:Array<ElixirAST> = [];
		function interpolationReferencesFromDo(start:Int, name:String):Bool {
			var hit = false;
			if (name == null || name.length == 0) return false;
			for (k  in  start ... stmts2.length) {
				switch (stmts2[k].def) {
					case EString(s) if (s != null && s.indexOf("#{") != -1 && s.indexOf(name) != -1):
						hit = true;					
					case ERaw(code) if (code != null && code.indexOf("#{") != -1 && code.indexOf(name) != -1):
						hit = true;					
					default:
				};
				if (hit) break;
			};
			return hit;
		};
		for (i  in  0 ... stmts2.length) {
			var s2 = stmts2[i];
			switch (s2.def) {
				case EBinary(Match, left2, rhs2):
					switch (left2.def) {
						case EVar(nm2):
							if (nm2 == "assigns") {
								out2.push(s2);
								break;
							};
							if (nm2 == "query" && filterPredicateUsesQueryLater(stmts2, i + 1)) {
								out2.push(s2);
							} else if (isDowncaseSearch(rhs2)) {
								out2.push(s2);
							} else if (!(inChangeset && rhsContainsChangesetCall(rhs2)) && !VarUseAnalyzer.usedLater(stmts2, i + 1, nm2) && !rawIdentifierUsedLater(stmts2, i + 1, nm2) && !exprReferencesName(rhs2, nm2) && !interpolationReferencesFromDo(i + 1, nm2) && (nm2.length > 0 && nm2.charAt(0) == "_") && !(nm2.length > 1 && (interpolationReferencesFromDo(i + 1, nm2.substr(1)) || rawIdentifierUsedLater(stmts2, i + 1, nm2.substr(1))))) {
								out2.push(makeASTWithMeta(EMatch(PWildcard, rhs2), s2.metadata, s2.pos));
							} else out2.push(s2);						
						default:
							out2.push(s2);						
					};				
				case EMatch(pat2, rhsDo):
					switch (pat2) {
						case PVar(nmDo):
							if (!(inChangeset && rhsContainsChangesetCall(rhsDo)) && !VarUseAnalyzer.usedLater(stmts2, i + 1, nmDo) && !rawIdentifierUsedLater(stmts2, i + 1, nmDo) && !exprReferencesName(rhsDo, nmDo) && !interpolationReferencesFromDo(i + 1, nmDo) && (nmDo.length > 0 && nmDo.charAt(0) == "_")) {
								out2.push(makeASTWithMeta(EMatch(PWildcard, rhsDo), s2.metadata, s2.pos));
							} else out2.push(s2);						
						default:
							out2.push(s2);						
					};				
				default:
					out2.push(s2);				
			};
		};
		makeASTWithMeta(EDo(out2), body.metadata, body.pos);	
	default:
		body;	
}) {
			var ` = body.def;
			switch (enumIndex `) {
				case 53: {
					var ` = `[0];
					{
						var stmts = `;
						{
							var out = [];
							var hasHeexFrom = function(start:Int) {
								var found = false;
								{
									var ` = start;
									var ` = stmts.length;
									while (` < `) {
										var k = ` ++;
										@:ast(switch (stmts[k].def) {
	case ESigil(type, _, _) if (type == "H"):
		found = true;	
	case ERaw(code) if (code != null && code.indexOf("~H\"") != -1):
		found = true;	
	default:
}) {
											var ` = stmts[k].def;
											switch (enumIndex `) {
												case 61: {
													var ` = `[0];
													var ` = `[1];
													var ` = `[2];
													{
														var type = `;
														if (type == "H") {
															found = true;
														} else {};
													};
												};
												case 62: {
													var ` = `[0];
													{
														var code = `;
														if (code != null && code.indexOf("~H\"", null) != -1) {
															found = true;
														} else {};
													};
												};
												default: {}
											};
										};
										if (found) {
											break;
										};
									};
								};
								return found;
							};
							var interpolationReferencesFrom = function(start:Int, name:String) {
								var hit = false;
								if (name == null || name.length == 0) {
									return false;
								};
								{
									var ` = start;
									var ` = stmts.length;
									while (` < `) {
										var k = ` ++;
										@:ast(switch (stmts[k].def) {
	case EString(s) if (s != null && s.indexOf("#{") != -1 && s.indexOf(name) != -1):
		hit = true;	
	case ERaw(code) if (code != null && code.indexOf("#{") != -1 && code.indexOf(name) != -1):
		hit = true;	
	default:
}) {
											var ` = stmts[k].def;
											switch (enumIndex `) {
												case 32: {
													var ` = `[0];
													{
														var s = `;
														if (s != null && s.indexOf("#{", null) != -1 && s.indexOf(name, null) != -1) {
															hit = true;
														} else {};
													};
												};
												case 62: {
													var ` = `[0];
													{
														var code = `;
														if (code != null && code.indexOf("#{", null) != -1 && code.indexOf(name, null) != -1) {
															hit = true;
														} else {};
													};
												};
												default: {}
											};
										};
										if (hit) {
											break;
										};
									};
								};
								return hit;
							};
							{
								var ` = 0;
								var ` = stmts.length;
								while (` < `) {
									var i = ` ++;
									var s = stmts[i];
									@:ast(switch (s.def) {
	case EBinary(Match, left, rhs):
		switch (left.def) {
			case EVar(nm):
				if (nm == "children") {
					out.push(s);
					break;
				};
				if (nm == "assigns") {
					out.push(s);
					break;
				};
				if (isPresenceEffectCall(rhs) || isLogTraceCall(rhs)) {
					out.push(s);
					break;
				};
				if (nm == "query" && filterPredicateUsesQueryLater(stmts, i + 1)) {
					out.push(s);
				} else if (isDowncaseSearch(rhs)) {
					out.push(s);
				} else if (!(inChangeset && rhsContainsChangesetCall(rhs)) && !VarUseAnalyzer.usedLater(stmts, i + 1, nm) && !rawIdentifierUsedLater(stmts, i + 1, nm) && !exprReferencesName(rhs, nm) && !hasPinnedVarInEctoWhere(stmts, i + 1, nm, s.metadata != null ? s.metadata.varId : null) && !repoCallUsesVarLater(stmts, i + 1, nm) && !hasPinnedVarInBlock(stmts, i + 1, nm) && !interpolationReferencesFrom(i + 1, nm) && (nm.length > 0 && nm.charAt(0) == "_") && !(nm.length > 1 && (interpolationReferencesFrom(i + 1, nm.substr(1)) || rawIdentifierUsedLater(stmts, i + 1, nm.substr(1))))) {
					out.push(makeASTWithMeta(EMatch(PWildcard, rhs), s.metadata, s.pos));
				} else out.push(s);			
			default:
				out.push(s);			
		};	
	case EMatch(pat, rhs2):
		switch (pat) {
			case PVar(nm2):
				if (nm2 == "children") {
					out.push(s);
					break;
				};
				if (nm2 == "assigns") {
					out.push(s);
					break;
				};
				if (isPresenceEffectCall(rhs2) || isLogTraceCall(rhs2)) {
					out.push(s);
					break;
				};
				if (isDowncaseSearch(rhs2)) {
					out.push(s);
				} else if (!(inChangeset && rhsContainsChangesetCall(rhs2)) && !VarUseAnalyzer.usedLater(stmts, i + 1, nm2) && !rawIdentifierUsedLater(stmts, i + 1, nm2) && !exprReferencesName(rhs2, nm2) && !hasPinnedVarInEctoWhere(stmts, i + 1, nm2, s.metadata != null ? s.metadata.varId : null) && !repoCallUsesVarLater(stmts, i + 1, nm2) && !hasPinnedVarInBlock(stmts, i + 1, nm2) && !interpolationReferencesFrom(i + 1, nm2) && (nm2.length > 0 && nm2.charAt(0) == "_") && !(nm2.length > 1 && (interpolationReferencesFrom(i + 1, nm2.substr(1)) || rawIdentifierUsedLater(stmts, i + 1, nm2.substr(1))))) {
					out.push(makeASTWithMeta(EMatch(PWildcard, rhs2), s.metadata, s.pos));
				} else out.push(s);			
			default:
				out.push(s);			
		};	
	default:
		out.push(s);	
}) {
										var ` = s.def;
										switch (enumIndex `) {
											case 8: {
												var ` = `[0];
												var ` = `[1];
												{
													var pat = `;
													var rhs2 = `;
													{
														@:ast(switch (pat) {
	case PVar(nm2):
		if (nm2 == "children") {
			out.push(s);
			break;
		};
		if (nm2 == "assigns") {
			out.push(s);
			break;
		};
		if (isPresenceEffectCall(rhs2) || isLogTraceCall(rhs2)) {
			out.push(s);
			break;
		};
		if (isDowncaseSearch(rhs2)) {
			out.push(s);
		} else if (!(inChangeset && rhsContainsChangesetCall(rhs2)) && !VarUseAnalyzer.usedLater(stmts, i + 1, nm2) && !rawIdentifierUsedLater(stmts, i + 1, nm2) && !exprReferencesName(rhs2, nm2) && !hasPinnedVarInEctoWhere(stmts, i + 1, nm2, s.metadata != null ? s.metadata.varId : null) && !repoCallUsesVarLater(stmts, i + 1, nm2) && !hasPinnedVarInBlock(stmts, i + 1, nm2) && !interpolationReferencesFrom(i + 1, nm2) && (nm2.length > 0 && nm2.charAt(0) == "_") && !(nm2.length > 1 && (interpolationReferencesFrom(i + 1, nm2.substr(1)) || rawIdentifierUsedLater(stmts, i + 1, nm2.substr(1))))) {
			out.push(makeASTWithMeta(EMatch(PWildcard, rhs2), s.metadata, s.pos));
		} else out.push(s);	
	default:
		out.push(s);	
}) if (enumIndex pat == 0) {
															var ` = pat[0];
															{
																var nm2 = `;
																{
																	if (nm2 == "children") {
																		out.push(s);
																		break;
																	};
																	if (nm2 == "assigns") {
																		out.push(s);
																		break;
																	};
																	if (reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.isPresenceEffectCall(rhs2) || reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.isLogTraceCall(rhs2)) {
																		out.push(s);
																		break;
																	};
																	if (reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.isDowncaseSearch(rhs2)) {
																		out.push(s);
																	} else {
																		if (! (inChangeset && reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rhsContainsChangesetCall(rhs2)) && ! reflaxe.elixir.ast.analyzers.VarUseAnalyzer.usedLater(stmts, i + 1, nm2) && ! reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rawIdentifierUsedLater(stmts, i + 1, nm2) && ! reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.exprReferencesName(rhs2, nm2) && ! reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.hasPinnedVarInEctoWhere(stmts, i + 1, nm2, if (s.metadata != null) {
																			s.metadata.varId;
																		} else {
																			null;
																		}) && ! reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.repoCallUsesVarLater(stmts, i + 1, nm2) && ! reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.hasPinnedVarInBlock(stmts, i + 1, nm2) && ! interpolationReferencesFrom(i + 1, nm2) && (nm2.length > 0 && nm2.charAt(0) == "_") && ! (nm2.length > 1 && (interpolationReferencesFrom(i + 1, nm2.substr(1, null)) || reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rawIdentifierUsedLater(stmts, i + 1, nm2.substr(1, null))))) {
																			out.push({def : reflaxe.elixir.ast.ElixirASTDef.EMatch(reflaxe.elixir.ast.EPattern.PWildcard, rhs2), metadata : s.metadata, pos : s.pos});
																		} else {
																			out.push(s);
																		};
																	};
																};
															};
														} else {
															out.push(s);
														};
													};
												};
											};
											case 26: {
												var ` = `[0];
												var ` = `[1];
												var ` = `[2];
												if (enumIndex ` == 27) {
													{
														var left = `;
														var rhs = `;
														{
															@:ast(switch (left.def) {
	case EVar(nm):
		if (nm == "children") {
			out.push(s);
			break;
		};
		if (nm == "assigns") {
			out.push(s);
			break;
		};
		if (isPresenceEffectCall(rhs) || isLogTraceCall(rhs)) {
			out.push(s);
			break;
		};
		if (nm == "query" && filterPredicateUsesQueryLater(stmts, i + 1)) {
			out.push(s);
		} else if (isDowncaseSearch(rhs)) {
			out.push(s);
		} else if (!(inChangeset && rhsContainsChangesetCall(rhs)) && !VarUseAnalyzer.usedLater(stmts, i + 1, nm) && !rawIdentifierUsedLater(stmts, i + 1, nm) && !exprReferencesName(rhs, nm) && !hasPinnedVarInEctoWhere(stmts, i + 1, nm, s.metadata != null ? s.metadata.varId : null) && !repoCallUsesVarLater(stmts, i + 1, nm) && !hasPinnedVarInBlock(stmts, i + 1, nm) && !interpolationReferencesFrom(i + 1, nm) && (nm.length > 0 && nm.charAt(0) == "_") && !(nm.length > 1 && (interpolationReferencesFrom(i + 1, nm.substr(1)) || rawIdentifierUsedLater(stmts, i + 1, nm.substr(1))))) {
			out.push(makeASTWithMeta(EMatch(PWildcard, rhs), s.metadata, s.pos));
		} else out.push(s);	
	default:
		out.push(s);	
}) {
																var ` = left.def;
																if (enumIndex ` == 38) {
																	var ` = `[0];
																	{
																		var nm = `;
																		{
																			if (nm == "children") {
																				out.push(s);
																				break;
																			};
																			if (nm == "assigns") {
																				out.push(s);
																				break;
																			};
																			if (reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.isPresenceEffectCall(rhs) || reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.isLogTraceCall(rhs)) {
																				out.push(s);
																				break;
																			};
																			if (nm == "query" && reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.filterPredicateUsesQueryLater(stmts, i + 1)) {
																				out.push(s);
																			} else {
																				if (reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.isDowncaseSearch(rhs)) {
																					out.push(s);
																				} else {
																					if (! (inChangeset && reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rhsContainsChangesetCall(rhs)) && ! reflaxe.elixir.ast.analyzers.VarUseAnalyzer.usedLater(stmts, i + 1, nm) && ! reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rawIdentifierUsedLater(stmts, i + 1, nm) && ! reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.exprReferencesName(rhs, nm) && ! reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.hasPinnedVarInEctoWhere(stmts, i + 1, nm, if (s.metadata != null) {
																						s.metadata.varId;
																					} else {
																						null;
																					}) && ! reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.repoCallUsesVarLater(stmts, i + 1, nm) && ! reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.hasPinnedVarInBlock(stmts, i + 1, nm) && ! interpolationReferencesFrom(i + 1, nm) && (nm.length > 0 && nm.charAt(0) == "_") && ! (nm.length > 1 && (interpolationReferencesFrom(i + 1, nm.substr(1, null)) || reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rawIdentifierUsedLater(stmts, i + 1, nm.substr(1, null))))) {
																						out.push({def : reflaxe.elixir.ast.ElixirASTDef.EMatch(reflaxe.elixir.ast.EPattern.PWildcard, rhs), metadata : s.metadata, pos : s.pos});
																					} else {
																						out.push(s);
																					};
																				};
																			};
																		};
																	};
																} else {
																	out.push(s);
																};
															};
														};
													};
												} else {
													out.push(s);
												};
											};
											default: {
												out.push(s);
											}
										};
									};
								};
							};
							{def : reflaxe.elixir.ast.ElixirASTDef.EBlock(out), metadata : body.metadata, pos : body.pos};
						};
					};
				};
				case 55: {
					var ` = `[0];
					{
						var stmts2 = `;
						{
							var out2 = [];
							var interpolationReferencesFromDo = function(start:Int, name:String) {
								var hit = false;
								if (name == null || name.length == 0) {
									return false;
								};
								{
									var ` = start;
									var ` = stmts2.length;
									while (` < `) {
										var k = ` ++;
										@:ast(switch (stmts2[k].def) {
	case EString(s) if (s != null && s.indexOf("#{") != -1 && s.indexOf(name) != -1):
		hit = true;	
	case ERaw(code) if (code != null && code.indexOf("#{") != -1 && code.indexOf(name) != -1):
		hit = true;	
	default:
}) {
											var ` = stmts2[k].def;
											switch (enumIndex `) {
												case 32: {
													var ` = `[0];
													{
														var s = `;
														if (s != null && s.indexOf("#{", null) != -1 && s.indexOf(name, null) != -1) {
															hit = true;
														} else {};
													};
												};
												case 62: {
													var ` = `[0];
													{
														var code = `;
														if (code != null && code.indexOf("#{", null) != -1 && code.indexOf(name, null) != -1) {
															hit = true;
														} else {};
													};
												};
												default: {}
											};
										};
										if (hit) {
											break;
										};
									};
								};
								return hit;
							};
							{
								var ` = 0;
								var ` = stmts2.length;
								while (` < `) {
									var i = ` ++;
									var s2 = stmts2[i];
									@:ast(switch (s2.def) {
	case EBinary(Match, left2, rhs2):
		switch (left2.def) {
			case EVar(nm2):
				if (nm2 == "assigns") {
					out2.push(s2);
					break;
				};
				if (nm2 == "query" && filterPredicateUsesQueryLater(stmts2, i + 1)) {
					out2.push(s2);
				} else if (isDowncaseSearch(rhs2)) {
					out2.push(s2);
				} else if (!(inChangeset && rhsContainsChangesetCall(rhs2)) && !VarUseAnalyzer.usedLater(stmts2, i + 1, nm2) && !rawIdentifierUsedLater(stmts2, i + 1, nm2) && !exprReferencesName(rhs2, nm2) && !interpolationReferencesFromDo(i + 1, nm2) && (nm2.length > 0 && nm2.charAt(0) == "_") && !(nm2.length > 1 && (interpolationReferencesFromDo(i + 1, nm2.substr(1)) || rawIdentifierUsedLater(stmts2, i + 1, nm2.substr(1))))) {
					out2.push(makeASTWithMeta(EMatch(PWildcard, rhs2), s2.metadata, s2.pos));
				} else out2.push(s2);			
			default:
				out2.push(s2);			
		};	
	case EMatch(pat2, rhsDo):
		switch (pat2) {
			case PVar(nmDo):
				if (!(inChangeset && rhsContainsChangesetCall(rhsDo)) && !VarUseAnalyzer.usedLater(stmts2, i + 1, nmDo) && !rawIdentifierUsedLater(stmts2, i + 1, nmDo) && !exprReferencesName(rhsDo, nmDo) && !interpolationReferencesFromDo(i + 1, nmDo) && (nmDo.length > 0 && nmDo.charAt(0) == "_")) {
					out2.push(makeASTWithMeta(EMatch(PWildcard, rhsDo), s2.metadata, s2.pos));
				} else out2.push(s2);			
			default:
				out2.push(s2);			
		};	
	default:
		out2.push(s2);	
}) {
										var ` = s2.def;
										switch (enumIndex `) {
											case 8: {
												var ` = `[0];
												var ` = `[1];
												{
													var pat2 = `;
													var rhsDo = `;
													{
														@:ast(switch (pat2) {
	case PVar(nmDo):
		if (!(inChangeset && rhsContainsChangesetCall(rhsDo)) && !VarUseAnalyzer.usedLater(stmts2, i + 1, nmDo) && !rawIdentifierUsedLater(stmts2, i + 1, nmDo) && !exprReferencesName(rhsDo, nmDo) && !interpolationReferencesFromDo(i + 1, nmDo) && (nmDo.length > 0 && nmDo.charAt(0) == "_")) {
			out2.push(makeASTWithMeta(EMatch(PWildcard, rhsDo), s2.metadata, s2.pos));
		} else out2.push(s2);	
	default:
		out2.push(s2);	
}) if (enumIndex pat2 == 0) {
															var ` = pat2[0];
															{
																var nmDo = `;
																{
																	if (! (inChangeset && reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rhsContainsChangesetCall(rhsDo)) && ! reflaxe.elixir.ast.analyzers.VarUseAnalyzer.usedLater(stmts2, i + 1, nmDo) && ! reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rawIdentifierUsedLater(stmts2, i + 1, nmDo) && ! reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.exprReferencesName(rhsDo, nmDo) && ! interpolationReferencesFromDo(i + 1, nmDo) && (nmDo.length > 0 && nmDo.charAt(0) == "_")) {
																		out2.push({def : reflaxe.elixir.ast.ElixirASTDef.EMatch(reflaxe.elixir.ast.EPattern.PWildcard, rhsDo), metadata : s2.metadata, pos : s2.pos});
																	} else {
																		out2.push(s2);
																	};
																};
															};
														} else {
															out2.push(s2);
														};
													};
												};
											};
											case 26: {
												var ` = `[0];
												var ` = `[1];
												var ` = `[2];
												if (enumIndex ` == 27) {
													{
														var left2 = `;
														var rhs2 = `;
														{
															@:ast(switch (left2.def) {
	case EVar(nm2):
		if (nm2 == "assigns") {
			out2.push(s2);
			break;
		};
		if (nm2 == "query" && filterPredicateUsesQueryLater(stmts2, i + 1)) {
			out2.push(s2);
		} else if (isDowncaseSearch(rhs2)) {
			out2.push(s2);
		} else if (!(inChangeset && rhsContainsChangesetCall(rhs2)) && !VarUseAnalyzer.usedLater(stmts2, i + 1, nm2) && !rawIdentifierUsedLater(stmts2, i + 1, nm2) && !exprReferencesName(rhs2, nm2) && !interpolationReferencesFromDo(i + 1, nm2) && (nm2.length > 0 && nm2.charAt(0) == "_") && !(nm2.length > 1 && (interpolationReferencesFromDo(i + 1, nm2.substr(1)) || rawIdentifierUsedLater(stmts2, i + 1, nm2.substr(1))))) {
			out2.push(makeASTWithMeta(EMatch(PWildcard, rhs2), s2.metadata, s2.pos));
		} else out2.push(s2);	
	default:
		out2.push(s2);	
}) {
																var ` = left2.def;
																if (enumIndex ` == 38) {
																	var ` = `[0];
																	{
																		var nm2 = `;
																		{
																			if (nm2 == "assigns") {
																				out2.push(s2);
																				break;
																			};
																			if (nm2 == "query" && reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.filterPredicateUsesQueryLater(stmts2, i + 1)) {
																				out2.push(s2);
																			} else {
																				if (reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.isDowncaseSearch(rhs2)) {
																					out2.push(s2);
																				} else {
																					if (! (inChangeset && reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rhsContainsChangesetCall(rhs2)) && ! reflaxe.elixir.ast.analyzers.VarUseAnalyzer.usedLater(stmts2, i + 1, nm2) && ! reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rawIdentifierUsedLater(stmts2, i + 1, nm2) && ! reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.exprReferencesName(rhs2, nm2) && ! interpolationReferencesFromDo(i + 1, nm2) && (nm2.length > 0 && nm2.charAt(0) == "_") && ! (nm2.length > 1 && (interpolationReferencesFromDo(i + 1, nm2.substr(1, null)) || reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rawIdentifierUsedLater(stmts2, i + 1, nm2.substr(1, null))))) {
																						out2.push({def : reflaxe.elixir.ast.ElixirASTDef.EMatch(reflaxe.elixir.ast.EPattern.PWildcard, rhs2), metadata : s2.metadata, pos : s2.pos});
																					} else {
																						out2.push(s2);
																					};
																				};
																			};
																		};
																	};
																} else {
																	out2.push(s2);
																};
															};
														};
													};
												} else {
													out2.push(s2);
												};
											};
											default: {
												out2.push(s2);
											}
										};
									};
								};
							};
							{def : reflaxe.elixir.ast.ElixirASTDef.EDo(out2), metadata : body.metadata, pos : body.pos};
						};
					};
				};
				default: {
					body;
				}
			};
		};
	}

	static function rhsContainsChangesetCall(e:reflaxe.elixir.ast.ElixirAST) {
		var found = [false];
		var scan = [null];
		scan[0] = function(n:reflaxe.elixir.ast.ElixirAST) {
			if (found[0] || n == null || n.def == null) {
				return;
			};
			@:ast(switch (n.def) {
	case ERemoteCall(mod, _, _):
		switch (mod.def) {
			case EVar(m) if (m == "Ecto.Changeset"):
				found = true;			
			default:
		};	
	case ERaw(code):
		if (code != null && code.indexOf("Ecto.Changeset.") != -1) found = true;	
	case ECall(t, _, as):
		if (t != null) scan(t);
		if (as != null) for (a  in  as) scan(a);	
	case ERemoteCall(t2, _, as2):
		scan(t2);
		if (as2 != null) for (a2  in  as2) scan(a2);	
	case EBinary(_, l, r):
		scan(l);
		scan(r);	
	case EMatch(_, rhs):
		scan(rhs);	
	case EBlock(ss):
		for (s  in  ss) scan(s);	
	default:
}) {
				var ` = n.def;
				switch (enumIndex `) {
					case 8: {
						var ` = `[0];
						var ` = `[1];
						{
							var rhs = `;
							{
								scan[0](rhs);
							};
						};
					};
					case 22: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var t = `;
							var as = `;
							{
								if (t != null) {
									scan[0](t);
								};
								if (as != null) {
									{
										var ` = 0;
										while (` < as.length) {
											var a = as[`];
											++ `;
											scan[0](a);
										};
									};
								};
							};
						};
					};
					case 24: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var mod = `;
							{
								@:ast(switch (mod.def) {
	case EVar(m) if (m == "Ecto.Changeset"):
		found = true;	
	default:
}) {
									var ` = mod.def;
									if (enumIndex ` == 38) {
										var ` = `[0];
										{
											var m = `;
											if (m == "Ecto.Changeset") {
												found[0] = true;
											} else {};
										};
									} else {};
								};
							};
						};
					};
					case 26: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var l = `;
							var r = `;
							{
								scan[0](l);
								scan[0](r);
							};
						};
					};
					case 53: {
						var ` = `[0];
						{
							var ss = `;
							{
								{
									var ` = 0;
									while (` < ss.length) {
										var s = ss[`];
										++ `;
										scan[0](s);
									};
								};
							};
						};
					};
					case 62: {
						var ` = `[0];
						{
							var code = `;
							{
								if (code != null && code.indexOf("Ecto.Changeset.", null) != -1) {
									found[0] = true;
								};
							};
						};
					};
					default: {}
				};
			};
		};
		scan[0](e);
		return found[0];
	}

	static function exprReferencesName(e:reflaxe.elixir.ast.ElixirAST, name:String) {
		var found = [false];
		var visit = [null];
		visit[0] = function(x:reflaxe.elixir.ast.ElixirAST) {
			if (found[0] || x == null || x.def == null) {
				return;
			};
			@:ast(switch (x.def) {
	case EVar(n) if (n == name):
		found = true;	
	case EBinary(_, l, r):
		visit(l);
		visit(r);	
	case EMatch(_, rhs):
		visit(rhs);	
	case ECall(t, _, args):
		if (t != null) visit(t);
		if (args != null) for (a  in  args) visit(a);	
	case ERemoteCall(m, _, args2):
		visit(m);
		if (args2 != null) for (a  in  args2) visit(a);	
	case EBlock(ss):
		for (s  in  ss) visit(s);	
	case EIf(c, t, el):
		visit(c);
		visit(t);
		if (el != null) visit(el);	
	case ECase(cond, cs):
		visit(cond);
		for (c  in  cs) {
			if (c.guard != null) visit(c.guard);
			visit(c.body);
		};	
	default:
}) {
				var ` = x.def;
				switch (enumIndex `) {
					case 6: {
						var ` = `[0];
						var ` = `[1];
						{
							var cond = `;
							var cs = `;
							{
								visit[0](cond);
								{
									var ` = 0;
									while (` < cs.length) {
										var c = cs[`];
										++ `;
										if (c.guard != null) {
											visit[0](c.guard);
										};
										visit[0](c.body);
									};
								};
							};
						};
					};
					case 8: {
						var ` = `[0];
						var ` = `[1];
						{
							var rhs = `;
							{
								visit[0](rhs);
							};
						};
					};
					case 10: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var c = `;
							var t = `;
							var el = `;
							{
								visit[0](c);
								visit[0](t);
								if (el != null) {
									visit[0](el);
								};
							};
						};
					};
					case 22: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var t = `;
							var args = `;
							{
								if (t != null) {
									visit[0](t);
								};
								if (args != null) {
									{
										var ` = 0;
										while (` < args.length) {
											var a = args[`];
											++ `;
											visit[0](a);
										};
									};
								};
							};
						};
					};
					case 24: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var m = `;
							var args2 = `;
							{
								visit[0](m);
								if (args2 != null) {
									{
										var ` = 0;
										while (` < args2.length) {
											var a = args2[`];
											++ `;
											visit[0](a);
										};
									};
								};
							};
						};
					};
					case 26: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var l = `;
							var r = `;
							{
								visit[0](l);
								visit[0](r);
							};
						};
					};
					case 38: {
						var ` = `[0];
						{
							var n = `;
							if (n == name) {
								found[0] = true;
							} else {};
						};
					};
					case 53: {
						var ` = `[0];
						{
							var ss = `;
							{
								{
									var ` = 0;
									while (` < ss.length) {
										var s = ss[`];
										++ `;
										visit[0](s);
									};
								};
							};
						};
					};
					default: {}
				};
			};
		};
		visit[0](e);
		return found[0];
	}

	static function repoCallUsesVarLater(stmts:Array<reflaxe.elixir.ast.ElixirAST>, startIdx:Int, name:String) {
		var found = [false];
		var usesInArgs = [null];
		usesInArgs[0] = function(args:Array<reflaxe.elixir.ast.ElixirAST>) {
			if (args == null) {
				return false;
			};
			{
				var ` = 0;
				while (` < args.length) {
					var a = args[`];
					++ `;
					@:ast(switch (a.def) {
	case EVar(v) if (v == name):
		return true;	
	case ECall(_, _, as):
		if (usesInArgs(as)) return true;	
	case ERemoteCall(_, _, as2):
		if (usesInArgs(as2)) return true;	
	case EBinary(_, l, r):
		if (usesInArgs([l, r])) return true;	
	case ETuple(es) | EList(es):
		if (usesInArgs(es)) return true;	
	default:
}) {
						var ` = a.def;
						switch (enumIndex `) {
							case 15: {
								var ` = `[0];
								{
									var es = `;
									{
										if (usesInArgs[0](es)) {
											return true;
										};
									};
								};
							};
							case 16: {
								var ` = `[0];
								{
									var es = `;
									{
										if (usesInArgs[0](es)) {
											return true;
										};
									};
								};
							};
							case 22: {
								var ` = `[0];
								var ` = `[1];
								var ` = `[2];
								{
									var as = `;
									{
										if (usesInArgs[0](as)) {
											return true;
										};
									};
								};
							};
							case 24: {
								var ` = `[0];
								var ` = `[1];
								var ` = `[2];
								{
									var as2 = `;
									{
										if (usesInArgs[0](as2)) {
											return true;
										};
									};
								};
							};
							case 26: {
								var ` = `[0];
								var ` = `[1];
								var ` = `[2];
								{
									var l = `;
									var r = `;
									{
										if (usesInArgs[0]([l, r])) {
											return true;
										};
									};
								};
							};
							case 38: {
								var ` = `[0];
								{
									var v = `;
									if (v == name) {
										return true;
									} else {};
								};
							};
							default: {}
						};
					};
				};
			};
			return false;
		};
		var scan = [null];
		scan[0] = function(n:reflaxe.elixir.ast.ElixirAST) {
			if (found[0] || n == null || n.def == null) {
				return;
			};
			@:ast(switch (n.def) {
	case ERemoteCall(mod, func, args):
		var isRepo = switch (mod.def) {
			case EVar(m):
				m != null && (StringTools.endsWith(m, ".Repo") || m == "Repo");			
			default:
				false;			
		};
		if (isRepo && (func == "insert" || func == "update" || func == "delete") && usesInArgs(args)) {
			found = true;
			return;
		};	
	case EBlock(ss):
		for (s  in  ss) {
			if (found) break;
			scan(s);
		};	
	case EDo(ss2):
		for (s  in  ss2) {
			if (found) break;
			scan(s);
		};	
	case EIf(c, t, e):
		scan(c);
		scan(t);
		if (e != null) scan(e);	
	case ECase(expr, cs):
		scan(expr);
		for (c  in  cs) {
			scan(c.body);
		};	
	case EMatch(_, rhs):
		scan(rhs);	
	case EBinary(Match, _, rhs2):
		scan(rhs2);	
	default:
}) {
				var ` = n.def;
				switch (enumIndex `) {
					case 6: {
						var ` = `[0];
						var ` = `[1];
						{
							var expr = `;
							var cs = `;
							{
								scan[0](expr);
								{
									var ` = 0;
									while (` < cs.length) {
										var c = cs[`];
										++ `;
										scan[0](c.body);
									};
								};
							};
						};
					};
					case 8: {
						var ` = `[0];
						var ` = `[1];
						{
							var rhs = `;
							{
								scan[0](rhs);
							};
						};
					};
					case 10: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var c = `;
							var t = `;
							var e = `;
							{
								scan[0](c);
								scan[0](t);
								if (e != null) {
									scan[0](e);
								};
							};
						};
					};
					case 24: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var mod = `;
							var func = `;
							var args = `;
							{
								var isRepo = @:ast(switch (mod.def) {
	case EVar(m):
		m != null && (StringTools.endsWith(m, ".Repo") || m == "Repo");	
	default:
		false;	
}) {
									var ` = mod.def;
									if (enumIndex ` == 38) {
										var ` = `[0];
										{
											var m = `;
											{
												m != null && (StringTools.endsWith(m, ".Repo") || m == "Repo");
											};
										};
									} else {
										false;
									};
								};
								if (isRepo && (func == "insert" || func == "update" || func == "delete") && usesInArgs[0](args)) {
									found[0] = true;
									return;
								};
							};
						};
					};
					case 26: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						if (enumIndex ` == 27) {
							{
								var rhs2 = `;
								{
									scan[0](rhs2);
								};
							};
						} else {};
					};
					case 53: {
						var ` = `[0];
						{
							var ss = `;
							{
								{
									var ` = 0;
									while (` < ss.length) {
										var s = ss[`];
										++ `;
										if (found[0]) {
											break;
										};
										scan[0](s);
									};
								};
							};
						};
					};
					case 55: {
						var ` = `[0];
						{
							var ss2 = `;
							{
								{
									var ` = 0;
									while (` < ss2.length) {
										var s = ss2[`];
										++ `;
										if (found[0]) {
											break;
										};
										scan[0](s);
									};
								};
							};
						};
					};
					default: {}
				};
			};
		};
		{
			var ` = startIdx;
			var ` = stmts.length;
			while (` < `) {
				var i = ` ++;
				scan[0](stmts[i]);
				if (found[0]) {
					break;
				};
			};
		};
		return found[0];
	}

	static function isPresenceEffectCall(e:reflaxe.elixir.ast.ElixirAST) {
		return @:ast(switch (e.def) {
	case ERemoteCall({ def : EVar(mod) }, func, _):
		var isPresence = (mod == "Phoenix.Presence") || StringTools.endsWith(mod, ".Presence") || (mod == "Presence");
		if (!isPresence) false else (func == "track" || func == "update" || func == "untrack");	
	default:
		false;	
}) {
			var ` = e.def;
			if (enumIndex ` == 24) {
				var ` = `[0];
				var ` = `[1];
				var ` = `[2];
				{
					var ` = `.def;
					var ` = `.metadata;
					var ` = `.pos;
					if (enumIndex ` == 38) {
						var ` = `[0];
						{
							var mod = `;
							var func = `;
							{
								var isPresence = (mod == "Phoenix.Presence") || StringTools.endsWith(mod, ".Presence") || (mod == "Presence");
								if (! isPresence) {
									false;
								} else {
									(func == "track" || func == "update" || func == "untrack");
								};
							};
						};
					} else {
						false;
					};
				};
			} else {
				false;
			};
		};
	}

	static function isLogTraceCall(e:reflaxe.elixir.ast.ElixirAST) {
		return @:ast(switch (e.def) {
	case ERemoteCall({ def : EVar(mod) }, func, _):
		(mod == "Log" || StringTools.endsWith(mod, ".Log")) && func == "trace";	
	case ECall({ def : EVar(mod2) }, func2, _):
		(mod2 == "Log" || StringTools.endsWith(mod2, ".Log")) && func2 == "trace";	
	default:
		false;	
}) {
			var ` = e.def;
			switch (enumIndex `) {
				case 22: {
					var ` = `[0];
					var ` = `[1];
					var ` = `[2];
					if (` == null) {
						false;
					} else {
						var ` = `.def;
						var ` = `.metadata;
						var ` = `.pos;
						if (enumIndex ` == 38) {
							var ` = `[0];
							{
								var mod2 = `;
								var func2 = `;
								{
									(mod2 == "Log" || StringTools.endsWith(mod2, ".Log")) && func2 == "trace";
								};
							};
						} else {
							false;
						};
					};
				};
				case 24: {
					var ` = `[0];
					var ` = `[1];
					var ` = `[2];
					{
						var ` = `.def;
						var ` = `.metadata;
						var ` = `.pos;
						if (enumIndex ` == 38) {
							var ` = `[0];
							{
								var mod = `;
								var func = `;
								{
									(mod == "Log" || StringTools.endsWith(mod, ".Log")) && func == "trace";
								};
							};
						} else {
							false;
						};
					};
				};
				default: {
					false;
				}
			};
		};
	}

	static function hasPinnedVarInEctoWhere(stmts:Array<reflaxe.elixir.ast.ElixirAST>, startIdx:Int, name:String, assignVarId:Null<Int> = null) {
		if (name == null || name.length == 0) {
			return false;
		};
		var found = [false];
		{};
		{};
		var candidates = [name];
		var sn = if (name == null || name.length == 0) {
			name;
		} else {
			var out = new StringBuf();
			{
				var ` = 0;
				var ` = name.length;
				while (` < `) {
					var i = ` ++;
					var ch = name.charAt(i);
					var isUpper = (ch.toUpperCase() == ch && ch.toLowerCase() != ch);
					if (isUpper && i > 0) {
						out.add("_");
					};
					out.add(ch.toLowerCase());
				};
			};
			out.toString();
		};
		if (sn != null && sn != name) {
			candidates.push(sn);
		};
		var cc = if (name == null || name.length == 0) {
			name;
		} else {
			var parts = name.split("_");
			if (parts.length == 1) {
				name;
			} else {
				var out = new StringBuf();
				{
					var ` = 0;
					var ` = parts.length;
					while (` < `) {
						var i = ` ++;
						var p = parts[i];
						if (p.length == 0) {
							continue;
						};
						if (i == 0) {
							out.add(p);
						} else {
							out.add(p.charAt(0).toUpperCase() + p.substr(1, null));
						};
					};
				};
				out.toString();
			};
		};
		if (cc != null && cc != name && cc != sn) {
			candidates.push(cc);
		};
		var scan = [null];
		scan[0] = function(n:reflaxe.elixir.ast.ElixirAST) {
			if (n == null || n.def == null || found[0]) {
				return;
			};
			@:ast(switch (n.def) {
	case ERemoteCall(mod, func, args) if (func == "where" && args != null && args.length >= 2):
		var cond = args[args.length - 1];
		var innerFound = false;
		ElixirASTTransformer.transformNode(cond, function(x:ElixirAST):ElixirAST {
			if (innerFound) return x;
			switch (x.def) {
				case EPin(inner):
					var u = switch (inner.def) {
						case EParen(p):
							p;						
						default:
							inner;						
					};
					switch (u.def) {
						case EVar(v):
							for (c  in  candidates) if (v == c) {
								innerFound = true;
								break;
							};
							if (!innerFound && assignVarId != null && u.metadata != null && u.metadata.sourceVarId != null) {
								if (u.metadata.sourceVarId == assignVarId) innerFound = true;
							};
							return x;						
						default:
							return x;						
					};				
				default:
					return x;				
			};
		});
		if (innerFound) found = true;	
	case ERaw(code) if (code != null):
		var containsWhere = (code.indexOf("where(") != -1) || (code.indexOf("Ecto.Query.where(") != -1);
		if (containsWhere) {
			for (c  in  candidates) {
				var needle = "^(" + c + ")";
				if (code.indexOf(needle) != -1) {
					found = true;
					break;
				};
			};
		};	
	case EBlock(ss):
		for (s  in  ss) scan(s);	
	case EDo(ss2):
		for (s  in  ss2) scan(s);	
	case EIf(c, t, e):
		scan(c);
		scan(t);
		if (e != null) scan(e);	
	case EBinary(_, l, r):
		scan(l);
		scan(r);	
	case EMatch(_, rhs):
		scan(rhs);	
	case ECall(tgt, _, args2):
		if (tgt != null) scan(tgt);
		for (a  in  args2) scan(a);	
	case ERemoteCall(tgt2, _, args3):
		scan(tgt2);
		for (a  in  args3) scan(a);	
	case ECase(expr, cs):
		scan(expr);
		for (c  in  cs) scan(c.body);	
	default:
}) {
				var ` = n.def;
				switch (enumIndex `) {
					case 6: {
						var ` = `[0];
						var ` = `[1];
						{
							var expr = `;
							var cs = `;
							{
								scan[0](expr);
								{
									var ` = 0;
									while (` < cs.length) {
										var c = cs[`];
										++ `;
										scan[0](c.body);
									};
								};
							};
						};
					};
					case 8: {
						var ` = `[0];
						var ` = `[1];
						{
							var rhs = `;
							{
								scan[0](rhs);
							};
						};
					};
					case 10: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var c = `;
							var t = `;
							var e = `;
							{
								scan[0](c);
								scan[0](t);
								if (e != null) {
									scan[0](e);
								};
							};
						};
					};
					case 22: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var tgt = `;
							var args2 = `;
							{
								if (tgt != null) {
									scan[0](tgt);
								};
								{
									var ` = 0;
									while (` < args2.length) {
										var a = args2[`];
										++ `;
										scan[0](a);
									};
								};
							};
						};
					};
					case 24: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var mod = `;
							var func = `;
							var args = `;
							if (func == "where" && args != null && args.length >= 2) {
								var cond = args[args.length - 1];
								var innerFound = [false];
								reflaxe.elixir.ast.ElixirASTTransformer.transformNode(cond, function(x:reflaxe.elixir.ast.ElixirAST) {
									if (innerFound[0]) {
										return x;
									};
									@:ast(switch (x.def) {
	case EPin(inner):
		var u = switch (inner.def) {
			case EParen(p):
				p;			
			default:
				inner;			
		};
		switch (u.def) {
			case EVar(v):
				for (c  in  candidates) if (v == c) {
					innerFound = true;
					break;
				};
				if (!innerFound && assignVarId != null && u.metadata != null && u.metadata.sourceVarId != null) {
					if (u.metadata.sourceVarId == assignVarId) innerFound = true;
				};
				return x;			
			default:
				return x;			
		};	
	default:
		return x;	
}) {
										var ` = x.def;
										if (enumIndex ` == 39) {
											var ` = `[0];
											{
												var inner = `;
												{
													var u = @:ast(switch (inner.def) {
	case EParen(p):
		p;	
	default:
		inner;	
}) {
														var ` = inner.def;
														if (enumIndex ` == 54) {
															var ` = `[0];
															{
																var p = `;
																{
																	p;
																};
															};
														} else {
															inner;
														};
													};
													@:ast(switch (u.def) {
	case EVar(v):
		for (c  in  candidates) if (v == c) {
			innerFound = true;
			break;
		};
		if (!innerFound && assignVarId != null && u.metadata != null && u.metadata.sourceVarId != null) {
			if (u.metadata.sourceVarId == assignVarId) innerFound = true;
		};
		return x;	
	default:
		return x;	
}) {
														var ` = u.def;
														if (enumIndex ` == 38) {
															var ` = `[0];
															{
																var v = `;
																{
																	{
																		var ` = 0;
																		while (` < candidates.length) {
																			var c = candidates[`];
																			++ `;
																			if (v == c) {
																				innerFound[0] = true;
																				break;
																			};
																		};
																	};
																	if (! innerFound[0] && assignVarId != null && u.metadata != null && u.metadata.sourceVarId != null) {
																		if (u.metadata.sourceVarId == assignVarId) {
																			innerFound[0] = true;
																		};
																	};
																	return x;
																};
															};
														} else {
															return x;
														};
													};
												};
											};
										} else {
											return x;
										};
									};
								});
								if (innerFound[0]) {
									found[0] = true;
								};
							} else {
								var tgt2 = `;
								var args3 = `;
								{
									scan[0](tgt2);
									{
										var ` = 0;
										while (` < args3.length) {
											var a = args3[`];
											++ `;
											scan[0](a);
										};
									};
								};
							};
						};
					};
					case 26: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var l = `;
							var r = `;
							{
								scan[0](l);
								scan[0](r);
							};
						};
					};
					case 53: {
						var ` = `[0];
						{
							var ss = `;
							{
								{
									var ` = 0;
									while (` < ss.length) {
										var s = ss[`];
										++ `;
										scan[0](s);
									};
								};
							};
						};
					};
					case 55: {
						var ` = `[0];
						{
							var ss2 = `;
							{
								{
									var ` = 0;
									while (` < ss2.length) {
										var s = ss2[`];
										++ `;
										scan[0](s);
									};
								};
							};
						};
					};
					case 62: {
						var ` = `[0];
						{
							var code = `;
							if (code != null) {
								var containsWhere = (code.indexOf("where(", null) != -1) || (code.indexOf("Ecto.Query.where(", null) != -1);
								if (containsWhere) {
									{
										var ` = 0;
										while (` < candidates.length) {
											var c = candidates[`];
											++ `;
											var needle = "^(" + c + ")";
											if (code.indexOf(needle, null) != -1) {
												found[0] = true;
												break;
											};
										};
									};
								};
							} else {};
						};
					};
					default: {}
				};
			};
		};
		{
			var ` = startIdx;
			var ` = stmts.length;
			while (` < `) {
				var j = ` ++;
				scan[0](stmts[j]);
				if (found[0]) {
					return true;
				};
			};
		};
		return false;
	}

	static function isDowncaseSearch(e:reflaxe.elixir.ast.ElixirAST) {
		return @:ast(switch (e.def) {
	case ERemoteCall({ def : EVar(m) }, "downcase", args) if (m == "String" && args != null && args.length == 1):
		switch (args[0].def) {
			case EVar(v) if (v == "search_query"):
				true;			
			default:
				false;			
		};	
	default:
		false;	
}) {
			var ` = e.def;
			if (enumIndex ` == 24) {
				var ` = `[0];
				var ` = `[1];
				var ` = `[2];
				{
					var ` = `.def;
					var ` = `.metadata;
					var ` = `.pos;
					if (enumIndex ` == 38) {
						var ` = `[0];
						if (` == "downcase") {
							{
								var m = `;
								var args = `;
								if (m == "String" && args != null && args.length == 1) {
									@:ast(switch (args[0].def) {
	case EVar(v) if (v == "search_query"):
		true;	
	default:
		false;	
}) {
										var ` = args[0].def;
										if (enumIndex ` == 38) {
											var ` = `[0];
											{
												var v = `;
												if (v == "search_query") {
													true;
												} else {
													false;
												};
											};
										} else {
											false;
										};
									};
								} else {
									false;
								};
							};
						} else {
							false;
						};
					} else {
						false;
					};
				};
			} else {
				false;
			};
		};
	}

	static function hasPinnedVarInBlock(stmts:Array<reflaxe.elixir.ast.ElixirAST>, startIdx:Int, name:String) {
		if (name == null || name.length == 0) {
			return false;
		};
		var found = [false];
		{};
		{};
		var candidates = [name];
		var sn = if (name == null || name.length == 0) {
			name;
		} else {
			var out = new StringBuf();
			{
				var ` = 0;
				var ` = name.length;
				while (` < `) {
					var i = ` ++;
					var ch = name.charAt(i);
					var isUpper = (ch.toUpperCase() == ch && ch.toLowerCase() != ch);
					if (isUpper && i > 0) {
						out.add("_");
					};
					out.add(ch.toLowerCase());
				};
			};
			out.toString();
		};
		if (sn != null && sn != name) {
			candidates.push(sn);
		};
		var cc = if (name == null || name.length == 0) {
			name;
		} else {
			var parts = name.split("_");
			if (parts.length == 1) {
				name;
			} else {
				var out = new StringBuf();
				{
					var ` = 0;
					var ` = parts.length;
					while (` < `) {
						var i = ` ++;
						var p = parts[i];
						if (p.length == 0) {
							continue;
						};
						if (i == 0) {
							out.add(p);
						} else {
							out.add(p.charAt(0).toUpperCase() + p.substr(1, null));
						};
					};
				};
				out.toString();
			};
		};
		if (cc != null && cc != name && cc != sn) {
			candidates.push(cc);
		};
		var scan = [null];
		scan[0] = function(n:reflaxe.elixir.ast.ElixirAST) {
			if (n == null || n.def == null || found[0]) {
				return;
			};
			@:ast(switch (n.def) {
	case EPin(inner):
		switch (inner.def) {
			case EVar(v):
				for (c  in  candidates) if (v == c) {
					found = true;
					return;
				};			
			default:
		};	
	case EBlock(ss):
		for (s  in  ss) scan(s);	
	case EDo(ss2):
		for (s  in  ss2) scan(s);	
	case EIf(c, t, e):
		scan(c);
		scan(t);
		if (e != null) scan(e);	
	case EBinary(_, l, r):
		scan(l);
		scan(r);	
	case EMatch(_, rhs):
		scan(rhs);	
	case ECall(tgt, _, args2):
		if (tgt != null) scan(tgt);
		for (a  in  args2) scan(a);	
	case ERemoteCall(tgt2, _, args3):
		scan(tgt2);
		for (a  in  args3) scan(a);	
	case ECase(expr, cs):
		scan(expr);
		for (c  in  cs) scan(c.body);	
	case ERaw(code) if (code != null):
		for (c  in  candidates) {
			var needle = "^(" + c + ")";
			if (code.indexOf(needle) != -1) {
				found = true;
				break;
			};
		};	
	default:
}) {
				var ` = n.def;
				switch (enumIndex `) {
					case 6: {
						var ` = `[0];
						var ` = `[1];
						{
							var expr = `;
							var cs = `;
							{
								scan[0](expr);
								{
									var ` = 0;
									while (` < cs.length) {
										var c = cs[`];
										++ `;
										scan[0](c.body);
									};
								};
							};
						};
					};
					case 8: {
						var ` = `[0];
						var ` = `[1];
						{
							var rhs = `;
							{
								scan[0](rhs);
							};
						};
					};
					case 10: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var c = `;
							var t = `;
							var e = `;
							{
								scan[0](c);
								scan[0](t);
								if (e != null) {
									scan[0](e);
								};
							};
						};
					};
					case 22: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var tgt = `;
							var args2 = `;
							{
								if (tgt != null) {
									scan[0](tgt);
								};
								{
									var ` = 0;
									while (` < args2.length) {
										var a = args2[`];
										++ `;
										scan[0](a);
									};
								};
							};
						};
					};
					case 24: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var tgt2 = `;
							var args3 = `;
							{
								scan[0](tgt2);
								{
									var ` = 0;
									while (` < args3.length) {
										var a = args3[`];
										++ `;
										scan[0](a);
									};
								};
							};
						};
					};
					case 26: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var l = `;
							var r = `;
							{
								scan[0](l);
								scan[0](r);
							};
						};
					};
					case 39: {
						var ` = `[0];
						{
							var inner = `;
							{
								@:ast(switch (inner.def) {
	case EVar(v):
		for (c  in  candidates) if (v == c) {
			found = true;
			return;
		};	
	default:
}) {
									var ` = inner.def;
									if (enumIndex ` == 38) {
										var ` = `[0];
										{
											var v = `;
											{
												{
													var ` = 0;
													while (` < candidates.length) {
														var c = candidates[`];
														++ `;
														if (v == c) {
															found[0] = true;
															return;
														};
													};
												};
											};
										};
									} else {};
								};
							};
						};
					};
					case 53: {
						var ` = `[0];
						{
							var ss = `;
							{
								{
									var ` = 0;
									while (` < ss.length) {
										var s = ss[`];
										++ `;
										scan[0](s);
									};
								};
							};
						};
					};
					case 55: {
						var ` = `[0];
						{
							var ss2 = `;
							{
								{
									var ` = 0;
									while (` < ss2.length) {
										var s = ss2[`];
										++ `;
										scan[0](s);
									};
								};
							};
						};
					};
					case 62: {
						var ` = `[0];
						{
							var code = `;
							if (code != null) {
								{
									var ` = 0;
									while (` < candidates.length) {
										var c = candidates[`];
										++ `;
										var needle = "^(" + c + ")";
										if (code.indexOf(needle, null) != -1) {
											found[0] = true;
											break;
										};
									};
								};
							} else {};
						};
					};
					default: {}
				};
			};
		};
		{
			var ` = startIdx;
			var ` = stmts.length;
			while (` < `) {
				var j = ` ++;
				scan[0](stmts[j]);
				if (found[0]) {
					return true;
				};
			};
		};
		return false;
	}

	static function filterPredicateUsesQueryLater(stmts:Array<reflaxe.elixir.ast.ElixirAST>, startIdx:Int) {
		{
			var ` = startIdx;
			var ` = stmts.length;
			while (` < `) {
				var i = ` ++;
				if (reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.stmtHasFilterQueryUse(stmts[i])) {
					return true;
				};
			};
		};
		return false;
	}

	static function rawIdentifierUsedLater(stmts:Array<reflaxe.elixir.ast.ElixirAST>, startIdx:Int, name:String) {
		if (name == null || name.length == 0) {
			return false;
		};
		{};
		{
			var ` = startIdx;
			var ` = stmts.length;
			while (` < `) {
				var i = ` ++;
				var s = stmts[i];
				@:ast(switch (s.def) {
	case ERaw(code) if (code != null):
		var idx = 0;
		while (true) {
			idx = code.indexOf(name, idx);
			if (idx == -1) break;
			var before = idx > 0 ? code.substr(idx - 1, 1) : null;
			var afterIdx = idx + name.length;
			var after = afterIdx < code.length ? code.substr(afterIdx, 1) : null;
			if (!isIdentChar(before) && !isIdentChar(after)) return true;
			idx = afterIdx;
		};	
	case EBlock(ss):
		if (rawIdentifierUsedLater(ss, 0, name)) return true;	
	case EDo(ss2):
		if (rawIdentifierUsedLater(ss2, 0, name)) return true;	
	case EIf(c, t, e):
		var tmpS = [c, t].concat(e != null ? [e] : []);
		if (rawIdentifierUsedLater(tmpS, 0, name)) return true;	
	default:
}) {
					var ` = s.def;
					switch (enumIndex `) {
						case 10: {
							var ` = `[0];
							var ` = `[1];
							var ` = `[2];
							{
								var c = `;
								var t = `;
								var e = `;
								{
									var tmpS = [c, t].concat(if (e != null) {
										[e];
									} else {
										[];
									});
									if (reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rawIdentifierUsedLater(tmpS, 0, name)) {
										return true;
									};
								};
							};
						};
						case 53: {
							var ` = `[0];
							{
								var ss = `;
								{
									if (reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rawIdentifierUsedLater(ss, 0, name)) {
										return true;
									};
								};
							};
						};
						case 55: {
							var ` = `[0];
							{
								var ss2 = `;
								{
									if (reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rawIdentifierUsedLater(ss2, 0, name)) {
										return true;
									};
								};
							};
						};
						case 62: {
							var ` = `[0];
							{
								var code = `;
								if (code != null) {
									var idx = 0;
									while (true) {
										idx = code.indexOf(name, idx);
										if (idx == -1) {
											break;
										};
										var before = if (idx > 0) {
											code.substr(idx - 1, 1);
										} else {
											null;
										};
										var afterIdx = idx + name.length;
										var after = if (afterIdx < code.length) {
											code.substr(afterIdx, 1);
										} else {
											null;
										};
										if (! if (before == null || before.length == 0) {
											false;
										} else {
											var ch = before.charCodeAt(0);
											(ch >= 48 && ch <= 57) || (ch >= 65 && ch <= 90) || (ch >= 97 && ch <= 122) || before == "_";
										} && ! if (after == null || after.length == 0) {
											false;
										} else {
											var ch = after.charCodeAt(0);
											(ch >= 48 && ch <= 57) || (ch >= 65 && ch <= 90) || (ch >= 97 && ch <= 122) || after == "_";
										}) {
											return true;
										};
										idx = afterIdx;
									};
								} else {};
							};
						};
						default: {}
					};
				};
			};
		};
		return false;
	}

	static function stmtHasFilterQueryUse(n:reflaxe.elixir.ast.ElixirAST) {
		var found = [false];
		{};
		var hasQueryInEFnBody = function(fn:reflaxe.elixir.ast.ElixirAST) {
			var inner = [false];
			reflaxe.elixir.ast.ElixirASTTransformer.transformNode(fn, function(x:reflaxe.elixir.ast.ElixirAST) {
				if (inner[0]) {
					return x;
				};
				@:ast(switch (x.def) {
	case EVar(nm) if (nm == "query"):
		inner = true;
		return x;	
	case ERaw(code) if (code != null):
		var start = 0;
		while (!inner) {
			var idx = code.indexOf("query", start);
			if (idx == -1) break;
			var before = idx > 0 ? code.substr(idx - 1, 1) : null;
			var afterIdx = idx + 5;
			var after = afterIdx < code.length ? code.substr(afterIdx, 1) : null;
			if (!isIdentChar(before) && !isIdentChar(after)) {
				inner = true;
				break;
			};
			start = idx + 5;
		};
		return x;	
	default:
		return x;	
}) {
					var ` = x.def;
					switch (enumIndex `) {
						case 38: {
							var ` = `[0];
							{
								var nm = `;
								if (nm == "query") {
									inner[0] = true;
									return x;
								} else {
									return x;
								};
							};
						};
						case 62: {
							var ` = `[0];
							{
								var code = `;
								if (code != null) {
									var start = 0;
									while (! inner[0]) {
										var idx = code.indexOf("query", start);
										if (idx == -1) {
											break;
										};
										var before = if (idx > 0) {
											code.substr(idx - 1, 1);
										} else {
											null;
										};
										var afterIdx = idx + 5;
										var after = if (afterIdx < code.length) {
											code.substr(afterIdx, 1);
										} else {
											null;
										};
										if (! if (before == null || before.length == 0) {
											false;
										} else {
											var ch = before.charCodeAt(0);
											(ch >= 48 && ch <= 57) || (ch >= 65 && ch <= 90) || (ch >= 97 && ch <= 122) || before == "_";
										} && ! if (after == null || after.length == 0) {
											false;
										} else {
											var ch = after.charCodeAt(0);
											(ch >= 48 && ch <= 57) || (ch >= 65 && ch <= 90) || (ch >= 97 && ch <= 122) || after == "_";
										}) {
											inner[0] = true;
											break;
										};
										start = idx + 5;
									};
									return x;
								} else {
									return x;
								};
							};
						};
						default: {
							return x;
						}
					};
				};
			});
			return inner[0];
		};
		var scan = [null];
		scan[0] = function(x:reflaxe.elixir.ast.ElixirAST) {
			if (x == null || x.def == null || found[0]) {
				return;
			};
			@:ast(switch (x.def) {
	case ERaw(code) if (code != null):
		if (code.indexOf("Enum.filter(") != -1 && rawContainsIdent(code, "query")) found = true;	
	case ERemoteCall({ def : EVar(m) }, "filter", args) if (m == "Enum" && args != null && args.length == 2):
		switch (args[1].def) {
			case EFn(cs) if (cs.length == 1):
				if (hasQueryInEFnBody(args[1])) found = true;			
			default:
		};	
	case ECall(_, "filter", args2) if (args2 != null && args2.length >= 1):
		var pred = args2[args2.length - 1];
		switch (pred.def) {
			case EFn(cs2) if (cs2.length == 1):
				if (hasQueryInEFnBody(pred)) found = true;			
			default:
		};	
	case EBlock(ss):
		for (s  in  ss) scan(s);	
	case EDo(ss2):
		for (s  in  ss2) scan(s);	
	case EIf(c, t, e):
		scan(c);
		scan(t);
		if (e != null) scan(e);	
	case EMatch(_, rhs):
		scan(rhs);	
	case EBinary(_, l, r):
		scan(l);
		scan(r);	
	case ECall(tgt, _, args3):
		if (tgt != null) scan(tgt);
		for (a  in  args3) scan(a);	
	case ERemoteCall(tgt2, _, args4):
		scan(tgt2);
		for (a  in  args4) scan(a);	
	case ECase(expr, cs):
		scan(expr);
		for (c  in  cs) scan(c.body);	
	default:
}) {
				var ` = x.def;
				switch (enumIndex `) {
					case 6: {
						var ` = `[0];
						var ` = `[1];
						{
							var expr = `;
							var cs = `;
							{
								scan[0](expr);
								{
									var ` = 0;
									while (` < cs.length) {
										var c = cs[`];
										++ `;
										scan[0](c.body);
									};
								};
							};
						};
					};
					case 8: {
						var ` = `[0];
						var ` = `[1];
						{
							var rhs = `;
							{
								scan[0](rhs);
							};
						};
					};
					case 10: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var c = `;
							var t = `;
							var e = `;
							{
								scan[0](c);
								scan[0](t);
								if (e != null) {
									scan[0](e);
								};
							};
						};
					};
					case 22: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						if (` == "filter") {
							{
								var args2 = `;
								if (args2 != null && args2.length >= 1) {
									var pred = args2[args2.length - 1];
									@:ast(switch (pred.def) {
	case EFn(cs2) if (cs2.length == 1):
		if (hasQueryInEFnBody(pred)) found = true;	
	default:
}) {
										var ` = pred.def;
										if (enumIndex ` == 42) {
											var ` = `[0];
											{
												var cs2 = `;
												if (cs2.length == 1) {
													if (hasQueryInEFnBody(pred)) {
														found[0] = true;
													};
												} else {};
											};
										} else {};
									};
								} else {
									var tgt = `;
									var args3 = `;
									{
										if (tgt != null) {
											scan[0](tgt);
										};
										{
											var ` = 0;
											while (` < args3.length) {
												var a = args3[`];
												++ `;
												scan[0](a);
											};
										};
									};
								};
							};
						} else {
							var tgt = `;
							var args3 = `;
							{
								if (tgt != null) {
									scan[0](tgt);
								};
								{
									var ` = 0;
									while (` < args3.length) {
										var a = args3[`];
										++ `;
										scan[0](a);
									};
								};
							};
						};
					};
					case 24: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var ` = `.def;
							var ` = `.metadata;
							var ` = `.pos;
							if (enumIndex ` == 38) {
								var ` = `[0];
								if (` == "filter") {
									{
										var m = `;
										var args = `;
										if (m == "Enum" && args != null && args.length == 2) {
											@:ast(switch (args[1].def) {
	case EFn(cs) if (cs.length == 1):
		if (hasQueryInEFnBody(args[1])) found = true;	
	default:
}) {
												var ` = args[1].def;
												if (enumIndex ` == 42) {
													var ` = `[0];
													{
														var cs = `;
														if (cs.length == 1) {
															if (hasQueryInEFnBody(args[1])) {
																found[0] = true;
															};
														} else {};
													};
												} else {};
											};
										} else {
											var tgt2 = `;
											var args4 = `;
											{
												scan[0](tgt2);
												{
													var ` = 0;
													while (` < args4.length) {
														var a = args4[`];
														++ `;
														scan[0](a);
													};
												};
											};
										};
									};
								} else {
									var tgt2 = `;
									var args4 = `;
									{
										scan[0](tgt2);
										{
											var ` = 0;
											while (` < args4.length) {
												var a = args4[`];
												++ `;
												scan[0](a);
											};
										};
									};
								};
							} else {
								var tgt2 = `;
								var args4 = `;
								{
									scan[0](tgt2);
									{
										var ` = 0;
										while (` < args4.length) {
											var a = args4[`];
											++ `;
											scan[0](a);
										};
									};
								};
							};
						};
					};
					case 26: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						{
							var l = `;
							var r = `;
							{
								scan[0](l);
								scan[0](r);
							};
						};
					};
					case 53: {
						var ` = `[0];
						{
							var ss = `;
							{
								{
									var ` = 0;
									while (` < ss.length) {
										var s = ss[`];
										++ `;
										scan[0](s);
									};
								};
							};
						};
					};
					case 55: {
						var ` = `[0];
						{
							var ss2 = `;
							{
								{
									var ` = 0;
									while (` < ss2.length) {
										var s = ss2[`];
										++ `;
										scan[0](s);
									};
								};
							};
						};
					};
					case 62: {
						var ` = `[0];
						{
							var code = `;
							if (code != null) {
								if (code.indexOf("Enum.filter(", null) != -1 && reflaxe.elixir.ast.transformers.BlockUnusedAssignmentDiscardTransforms.rawContainsIdent(code, "query")) {
									found[0] = true;
								};
							} else {};
						};
					};
					default: {}
				};
			};
		};
		scan[0](n);
		return found[0];
	}

	static inline function isIdentChar(c:String) {
		if (c == null || c.length == 0) {
			return false;
		};
		var ch = c.charCodeAt(0);
		return (ch >= 48 && ch <= 57) || (ch >= 65 && ch <= 90) || (ch >= 97 && ch <= 122) || c == "_";
	}

	static function rawContainsIdent(code:String, ident:String) {
		if (code == null || ident == null || ident.length == 0) {
			return false;
		};
		var start = 0;
		var len = ident.length;
		while (true) {
			var i = code.indexOf(ident, start);
			if (i == -1) {
				break;
			};
			var before = if (i > 0) {
				code.substr(i - 1, 1);
			} else {
				null;
			};
			var afterIdx = i + len;
			var after = if (afterIdx < code.length) {
				code.substr(afterIdx, 1);
			} else {
				null;
			};
			if (! if (before == null || before.length == 0) {
				false;
			} else {
				var ch = before.charCodeAt(0);
				(ch >= 48 && ch <= 57) || (ch >= 65 && ch <= 90) || (ch >= 97 && ch <= 122) || before == "_";
			} && ! if (after == null || after.length == 0) {
				false;
			} else {
				var ch = after.charCodeAt(0);
				(ch >= 48 && ch <= 57) || (ch >= 65 && ch <= 90) || (ch >= 97 && ch <= 122) || after == "_";
			}) {
				return true;
			};
			start = i + len;
		};
		return false;
	}
}