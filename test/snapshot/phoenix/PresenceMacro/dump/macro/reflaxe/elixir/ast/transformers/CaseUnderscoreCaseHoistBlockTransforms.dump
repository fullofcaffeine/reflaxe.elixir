class reflaxe.elixir.ast.transformers.CaseUnderscoreCaseHoistBlockTransforms {

	static inline function isDiscardPattern(p:reflaxe.elixir.ast.EPattern) {
		return @:ast(switch (p) {
	case PVar(name) if (name == "_"):
		true;	
	case PWildcard:
		true;	
	case PPin(inner):
		isDiscardPattern(inner);	
	default:
		false;	
}) switch (enumIndex p) {
			case 0: {
				var ` = p[0];
				{
					var name = `;
					if (name == "_") {
						true;
					} else {
						false;
					};
				};
			};
			case 7: {
				var ` = p[0];
				{
					var inner = `;
					{
						reflaxe.elixir.ast.transformers.CaseUnderscoreCaseHoistBlockTransforms.isDiscardPattern(inner);
					};
				};
			};
			case 8: {
				{
					true;
				};
			};
			default: {
				false;
			}
		};
	}

	public static function transformPass(ast:reflaxe.elixir.ast.ElixirAST) {
		return reflaxe.elixir.ast.ElixirASTTransformer.transformNode(ast, function(n:reflaxe.elixir.ast.ElixirAST) {
			return @:ast(switch (n.def) {
	case EBlock(stmts):
		var out:Array<ElixirAST> = [];
		for (i  in  0 ... stmts.length) {
			var s = stmts[i];
			s = transformPass(s);
			var hoisted = false;
			switch (s.def) {
				case EMatch(pat, { def : ECase(scrut, clauses) }) if (isDiscardPattern(pat)):
					var assign = makeASTWithMeta(EBinary(Match, makeASTWithMeta(EVar("parsed_result"), s.metadata, s.pos), scrut), s.metadata, s.pos);
					var caze = makeASTWithMeta(ECase(makeASTWithMeta(EVar("parsed_result"), s.metadata, s.pos), clauses), s.metadata, s.pos);
					out.push(assign);
					out.push(caze);
					hoisted = true;				
				case EBinary(Match, { def : EVar("_") }, { def : ECase(scr2, cls2) }):
					var assign2 = makeASTWithMeta(EBinary(Match, makeASTWithMeta(EVar("parsed_result"), s.metadata, s.pos), scr2), s.metadata, s.pos);
					var caze2 = makeASTWithMeta(ECase(makeASTWithMeta(EVar("parsed_result"), s.metadata, s.pos), cls2), s.metadata, s.pos);
					out.push(assign2);
					out.push(caze2);
					hoisted = true;				
				default:
			};
			if (!hoisted) out.push(s);
		};
		makeASTWithMeta(EBlock(out), n.metadata, n.pos);	
	case EDo(stmts2):
		var out2:Array<ElixirAST> = [];
		for (i2  in  0 ... stmts2.length) {
			var s2 = stmts2[i2];
			s2 = transformPass(s2);
			var hoisted2 = false;
			switch (s2.def) {
				case EMatch(p3, { def : ECase(scr3, cls3) }) if (isDiscardPattern(p3)):
					var assign3 = makeASTWithMeta(EBinary(Match, makeASTWithMeta(EVar("parsed_result"), s2.metadata, s2.pos), scr3), s2.metadata, s2.pos);
					var caze3 = makeASTWithMeta(ECase(makeASTWithMeta(EVar("parsed_result"), s2.metadata, s2.pos), cls3), s2.metadata, s2.pos);
					out2.push(assign3);
					out2.push(caze3);
					hoisted2 = true;				
				case EBinary(Match, { def : EVar("_") }, { def : ECase(scr4, cls4) }):
					var assign4 = makeASTWithMeta(EBinary(Match, makeASTWithMeta(EVar("parsed_result"), s2.metadata, s2.pos), scr4), s2.metadata, s2.pos);
					var caze4 = makeASTWithMeta(ECase(makeASTWithMeta(EVar("parsed_result"), s2.metadata, s2.pos), cls4), s2.metadata, s2.pos);
					out2.push(assign4);
					out2.push(caze4);
					hoisted2 = true;				
				default:
			};
			if (!hoisted2) out2.push(s2);
		};
		makeASTWithMeta(EDo(out2), n.metadata, n.pos);	
	default:
		n;	
}) {
				var ` = n.def;
				switch (enumIndex `) {
					case 53: {
						var ` = `[0];
						{
							var stmts = `;
							{
								var out = [];
								{
									var ` = 0;
									var ` = stmts.length;
									while (` < `) {
										var i = ` ++;
										var s = stmts[i];
										s = reflaxe.elixir.ast.transformers.CaseUnderscoreCaseHoistBlockTransforms.transformPass(s);
										var hoisted = false;
										@:ast(switch (s.def) {
	case EMatch(pat, { def : ECase(scrut, clauses) }) if (isDiscardPattern(pat)):
		var assign = makeASTWithMeta(EBinary(Match, makeASTWithMeta(EVar("parsed_result"), s.metadata, s.pos), scrut), s.metadata, s.pos);
		var caze = makeASTWithMeta(ECase(makeASTWithMeta(EVar("parsed_result"), s.metadata, s.pos), clauses), s.metadata, s.pos);
		out.push(assign);
		out.push(caze);
		hoisted = true;	
	case EBinary(Match, { def : EVar("_") }, { def : ECase(scr2, cls2) }):
		var assign2 = makeASTWithMeta(EBinary(Match, makeASTWithMeta(EVar("parsed_result"), s.metadata, s.pos), scr2), s.metadata, s.pos);
		var caze2 = makeASTWithMeta(ECase(makeASTWithMeta(EVar("parsed_result"), s.metadata, s.pos), cls2), s.metadata, s.pos);
		out.push(assign2);
		out.push(caze2);
		hoisted = true;	
	default:
}) {
											var ` = s.def;
											switch (enumIndex `) {
												case 8: {
													var ` = `[0];
													var ` = `[1];
													{
														var ` = `.def;
														var ` = `.metadata;
														var ` = `.pos;
														if (enumIndex ` == 6) {
															var ` = `[0];
															var ` = `[1];
															{
																var scrut = `;
																var clauses = `;
																var pat = `;
																if (@:ast(switch (p) {
	case PVar(name) if (name == "_"):
		true;	
	case PWildcard:
		true;	
	case PPin(inner):
		isDiscardPattern(inner);	
	default:
		false;	
}) switch (enumIndex pat) {
																	case 0: {
																		var ` = pat[0];
																		{
																			var name = `;
																			if (name == "_") {
																				true;
																			} else {
																				false;
																			};
																		};
																	};
																	case 7: {
																		var ` = pat[0];
																		{
																			var inner = `;
																			{
																				reflaxe.elixir.ast.transformers.CaseUnderscoreCaseHoistBlockTransforms.isDiscardPattern(inner);
																			};
																		};
																	};
																	case 8: {
																		{
																			true;
																		};
																	};
																	default: {
																		false;
																	}
																}) {
																	var assign = {def : reflaxe.elixir.ast.ElixirASTDef.EBinary(reflaxe.elixir.ast.EBinaryOp.Match, {def : reflaxe.elixir.ast.ElixirASTDef.EVar("parsed_result"), metadata : s.metadata, pos : s.pos}, scrut), metadata : s.metadata, pos : s.pos};
																	var caze = {def : reflaxe.elixir.ast.ElixirASTDef.ECase({def : reflaxe.elixir.ast.ElixirASTDef.EVar("parsed_result"), metadata : s.metadata, pos : s.pos}, clauses), metadata : s.metadata, pos : s.pos};
																	out.push(assign);
																	out.push(caze);
																	hoisted = true;
																} else {};
															};
														} else {};
													};
												};
												case 26: {
													var ` = `[0];
													var ` = `[1];
													var ` = `[2];
													if (enumIndex ` == 27) {
														{
															var ` = `.def;
															var ` = `.metadata;
															var ` = `.pos;
															if (enumIndex ` == 38) {
																var ` = `[0];
																if (` == "_") {
																	{
																		var ` = `.def;
																		var ` = `.metadata;
																		var ` = `.pos;
																		if (enumIndex ` == 6) {
																			var ` = `[0];
																			var ` = `[1];
																			{
																				var scr2 = `;
																				var cls2 = `;
																				{
																					var assign2 = {def : reflaxe.elixir.ast.ElixirASTDef.EBinary(reflaxe.elixir.ast.EBinaryOp.Match, {def : reflaxe.elixir.ast.ElixirASTDef.EVar("parsed_result"), metadata : s.metadata, pos : s.pos}, scr2), metadata : s.metadata, pos : s.pos};
																					var caze2 = {def : reflaxe.elixir.ast.ElixirASTDef.ECase({def : reflaxe.elixir.ast.ElixirASTDef.EVar("parsed_result"), metadata : s.metadata, pos : s.pos}, cls2), metadata : s.metadata, pos : s.pos};
																					out.push(assign2);
																					out.push(caze2);
																					hoisted = true;
																				};
																			};
																		} else {};
																	};
																} else {};
															} else {};
														};
													} else {};
												};
												default: {}
											};
										};
										if (! hoisted) {
											out.push(s);
										};
									};
								};
								{def : reflaxe.elixir.ast.ElixirASTDef.EBlock(out), metadata : n.metadata, pos : n.pos};
							};
						};
					};
					case 55: {
						var ` = `[0];
						{
							var stmts2 = `;
							{
								var out2 = [];
								{
									var ` = 0;
									var ` = stmts2.length;
									while (` < `) {
										var i2 = ` ++;
										var s2 = stmts2[i2];
										s2 = reflaxe.elixir.ast.transformers.CaseUnderscoreCaseHoistBlockTransforms.transformPass(s2);
										var hoisted2 = false;
										@:ast(switch (s2.def) {
	case EMatch(p3, { def : ECase(scr3, cls3) }) if (isDiscardPattern(p3)):
		var assign3 = makeASTWithMeta(EBinary(Match, makeASTWithMeta(EVar("parsed_result"), s2.metadata, s2.pos), scr3), s2.metadata, s2.pos);
		var caze3 = makeASTWithMeta(ECase(makeASTWithMeta(EVar("parsed_result"), s2.metadata, s2.pos), cls3), s2.metadata, s2.pos);
		out2.push(assign3);
		out2.push(caze3);
		hoisted2 = true;	
	case EBinary(Match, { def : EVar("_") }, { def : ECase(scr4, cls4) }):
		var assign4 = makeASTWithMeta(EBinary(Match, makeASTWithMeta(EVar("parsed_result"), s2.metadata, s2.pos), scr4), s2.metadata, s2.pos);
		var caze4 = makeASTWithMeta(ECase(makeASTWithMeta(EVar("parsed_result"), s2.metadata, s2.pos), cls4), s2.metadata, s2.pos);
		out2.push(assign4);
		out2.push(caze4);
		hoisted2 = true;	
	default:
}) {
											var ` = s2.def;
											switch (enumIndex `) {
												case 8: {
													var ` = `[0];
													var ` = `[1];
													{
														var ` = `.def;
														var ` = `.metadata;
														var ` = `.pos;
														if (enumIndex ` == 6) {
															var ` = `[0];
															var ` = `[1];
															{
																var scr3 = `;
																var cls3 = `;
																var p3 = `;
																if (@:ast(switch (p) {
	case PVar(name) if (name == "_"):
		true;	
	case PWildcard:
		true;	
	case PPin(inner):
		isDiscardPattern(inner);	
	default:
		false;	
}) switch (enumIndex p3) {
																	case 0: {
																		var ` = p3[0];
																		{
																			var name = `;
																			if (name == "_") {
																				true;
																			} else {
																				false;
																			};
																		};
																	};
																	case 7: {
																		var ` = p3[0];
																		{
																			var inner = `;
																			{
																				reflaxe.elixir.ast.transformers.CaseUnderscoreCaseHoistBlockTransforms.isDiscardPattern(inner);
																			};
																		};
																	};
																	case 8: {
																		{
																			true;
																		};
																	};
																	default: {
																		false;
																	}
																}) {
																	var assign3 = {def : reflaxe.elixir.ast.ElixirASTDef.EBinary(reflaxe.elixir.ast.EBinaryOp.Match, {def : reflaxe.elixir.ast.ElixirASTDef.EVar("parsed_result"), metadata : s2.metadata, pos : s2.pos}, scr3), metadata : s2.metadata, pos : s2.pos};
																	var caze3 = {def : reflaxe.elixir.ast.ElixirASTDef.ECase({def : reflaxe.elixir.ast.ElixirASTDef.EVar("parsed_result"), metadata : s2.metadata, pos : s2.pos}, cls3), metadata : s2.metadata, pos : s2.pos};
																	out2.push(assign3);
																	out2.push(caze3);
																	hoisted2 = true;
																} else {};
															};
														} else {};
													};
												};
												case 26: {
													var ` = `[0];
													var ` = `[1];
													var ` = `[2];
													if (enumIndex ` == 27) {
														{
															var ` = `.def;
															var ` = `.metadata;
															var ` = `.pos;
															if (enumIndex ` == 38) {
																var ` = `[0];
																if (` == "_") {
																	{
																		var ` = `.def;
																		var ` = `.metadata;
																		var ` = `.pos;
																		if (enumIndex ` == 6) {
																			var ` = `[0];
																			var ` = `[1];
																			{
																				var scr4 = `;
																				var cls4 = `;
																				{
																					var assign4 = {def : reflaxe.elixir.ast.ElixirASTDef.EBinary(reflaxe.elixir.ast.EBinaryOp.Match, {def : reflaxe.elixir.ast.ElixirASTDef.EVar("parsed_result"), metadata : s2.metadata, pos : s2.pos}, scr4), metadata : s2.metadata, pos : s2.pos};
																					var caze4 = {def : reflaxe.elixir.ast.ElixirASTDef.ECase({def : reflaxe.elixir.ast.ElixirASTDef.EVar("parsed_result"), metadata : s2.metadata, pos : s2.pos}, cls4), metadata : s2.metadata, pos : s2.pos};
																					out2.push(assign4);
																					out2.push(caze4);
																					hoisted2 = true;
																				};
																			};
																		} else {};
																	};
																} else {};
															} else {};
														};
													} else {};
												};
												default: {}
											};
										};
										if (! hoisted2) {
											out2.push(s2);
										};
									};
								};
								{def : reflaxe.elixir.ast.ElixirASTDef.EDo(out2), metadata : n.metadata, pos : n.pos};
							};
						};
					};
					default: {
						n;
					}
				};
			};
		});
	}
}