class reflaxe.elixir.ast.transformers.FilterPredicateQueryInlineUltraFinalTransforms {

	public static function pass(ast:reflaxe.elixir.ast.ElixirAST) {
		return reflaxe.elixir.ast.ElixirASTTransformer.transformNode(ast, function(n:reflaxe.elixir.ast.ElixirAST) {
			return @:ast(switch (n.def) {
	case EBlock(stmts) if (stmts.length > 0):
		makeASTWithMeta(EBlock(rewrite(stmts)), n.metadata, n.pos);	
	case EDo(stmts2) if (stmts2.length > 0):
		makeASTWithMeta(EDo(rewrite(stmts2)), n.metadata, n.pos);	
	default:
		n;	
}) {
				var ` = n.def;
				switch (enumIndex `) {
					case 53: {
						var ` = `[0];
						{
							var stmts = `;
							if (stmts.length > 0) {
								{
									var def = reflaxe.elixir.ast.ElixirASTDef.EBlock(reflaxe.elixir.ast.transformers.FilterPredicateQueryInlineUltraFinalTransforms.rewrite(stmts));
									var meta = n.metadata;
									var pos = n.pos;
									{def : def, metadata : meta, pos : pos};
								};
							} else {
								n;
							};
						};
					};
					case 55: {
						var ` = `[0];
						{
							var stmts2 = `;
							if (stmts2.length > 0) {
								{
									var def = reflaxe.elixir.ast.ElixirASTDef.EDo(reflaxe.elixir.ast.transformers.FilterPredicateQueryInlineUltraFinalTransforms.rewrite(stmts2));
									var meta = n.metadata;
									var pos = n.pos;
									{def : def, metadata : meta, pos : pos};
								};
							} else {
								n;
							};
						};
					};
					default: {
						n;
					}
				};
			};
		});
	}

	static function rewrite(stmts:Array<reflaxe.elixir.ast.ElixirAST>) {
		var out = [];
		var hasDefinedQuery = function(before:Int) {
			{
				var ` = 0;
				var ` = before;
				while (` < `) {
					var k = ` ++;
					@:ast(switch (stmts[k].def) {
	case EBinary(Match, left, _):
		switch (left.def) {
			case EVar(nm) if (nm == "query"):
				return true;			
			default:
		};	
	case EMatch(pat, _):
		switch (pat) {
			case PVar(n) if (n == "query"):
				return true;			
			default:
		};	
	default:
}) {
						var ` = stmts[k].def;
						switch (enumIndex `) {
							case 8: {
								var ` = `[0];
								var ` = `[1];
								{
									var pat = `;
									{
										@:ast(switch (pat) {
	case PVar(n) if (n == "query"):
		return true;	
	default:
}) if (enumIndex pat == 0) {
											var ` = pat[0];
											{
												var n = `;
												if (n == "query") {
													return true;
												} else {};
											};
										} else {};
									};
								};
							};
							case 26: {
								var ` = `[0];
								var ` = `[1];
								var ` = `[2];
								if (enumIndex ` == 27) {
									{
										var left = `;
										{
											@:ast(switch (left.def) {
	case EVar(nm) if (nm == "query"):
		return true;	
	default:
}) {
												var ` = left.def;
												if (enumIndex ` == 38) {
													var ` = `[0];
													{
														var nm = `;
														if (nm == "query") {
															return true;
														} else {};
													};
												} else {};
											};
										};
									};
								} else {};
							};
							default: {}
						};
					};
				};
			};
			return false;
		};
		var blockHasSearchQuery = function() {
			var found = [false];
			{
				var ` = 0;
				while (` < stmts.length) {
					var s = stmts[`];
					++ `;
					reflaxe.elixir.ast.ElixirASTTransformer.transformNode(s, function(x:reflaxe.elixir.ast.ElixirAST) {
						if (found[0]) {
							return x;
						};
						@:ast(switch (x.def) {
	case EVar(nm) if (nm == "search_query"):
		found = true;
		return x;	
	default:
		return x;	
}) {
							var ` = x.def;
							if (enumIndex ` == 38) {
								var ` = `[0];
								{
									var nm = `;
									if (nm == "search_query") {
										found[0] = true;
										return x;
									} else {
										return x;
									};
								};
							} else {
								return x;
							};
						};
					});
					if (found[0]) {
						break;
					};
				};
			};
			return found[0];
		};
		{};
		var canInline = blockHasSearchQuery();
		{
			var ` = 0;
			var ` = stmts.length;
			while (` < `) {
				var i = ` ++;
				var s = stmts[i];
				if (canInline && ! hasDefinedQuery(i)) {
					@:ast(switch (s.def) {
	case ERemoteCall(mod, "filter", args) if (args.length == 2):
		switch (args[1].def) {
			case EFn(clauses) if (clauses.length == 1):
				var cl = clauses[0];
				var usesQuery = false;
				ElixirASTTransformer.transformNode(cl.body, function(x:ElixirAST):ElixirAST {
					if (usesQuery) return x;
					switch (x.def) {
						case EVar(nm) if (nm == "query"):
							usesQuery = true;
							return x;						
						default:
							return x;						
					};
				});
				if (usesQuery) {
					var nb = inlineQuery(cl.body);
					var newFn = makeAST(EFn([{ args : cl.args, guard : cl.guard, body : nb }]));
					out.push(makeASTWithMeta(ERemoteCall(mod, "filter", [args[0], newFn]), s.metadata, s.pos));
					continue;
				};			
			default:
		};	
	case ECall(target, "filter", args2) if (args2.length == 2):
		switch (args2[1].def) {
			case EFn(clauses) if (clauses.length == 1):
				var cl2 = clauses[0];
				var usesQ = false;
				ElixirASTTransformer.transformNode(cl2.body, function(x2:ElixirAST):ElixirAST {
					if (usesQ) return x2;
					switch (x2.def) {
						case EVar(nm2) if (nm2 == "query"):
							usesQ = true;
							return x2;						
						default:
							return x2;						
					};
				});
				if (usesQ) {
					var nb2 = inlineQuery(cl2.body);
					var newFn2 = makeAST(EFn([{ args : cl2.args, guard : cl2.guard, body : nb2 }]));
					out.push(makeASTWithMeta(ECall(target, "filter", [args2[0], newFn2]), s.metadata, s.pos));
					continue;
				};			
			default:
		};	
	case EMatch(lhs, rhs):
		switch (rhs.def) {
			case ERemoteCall(mod2, "filter", a3) if (a3.length == 2):
				switch (a3[1].def) {
					case EFn(clauses3) if (clauses3.length == 1):
						var cl3 = clauses3[0];
						var uq = false;
						ElixirASTTransformer.transformNode(cl3.body, function(xx:ElixirAST):ElixirAST {
							if (uq) return xx;
							switch (xx.def) {
								case EVar(nmm) if (nmm == "query"):
									uq = true;
									return xx;								
								default:
									return xx;								
							};
						});
						if (uq) {
							var nb3 = inlineQuery(cl3.body);
							var newFn3 = makeAST(EFn([{ args : cl3.args, guard : cl3.guard, body : nb3 }]));
							out.push(makeASTWithMeta(EMatch(lhs, makeAST(ERemoteCall(mod2, "filter", [a3[0], newFn3]))), s.metadata, s.pos));
							continue;
						};					
					default:
				};			
			case ECall(target2, "filter", a4) if (a4.length == 2):
				switch (a4[1].def) {
					case EFn(clauses4) if (clauses4.length == 1):
						var cl4 = clauses4[0];
						var uq2 = false;
						ElixirASTTransformer.transformNode(cl4.body, function(yy:ElixirAST):ElixirAST {
							if (uq2) return yy;
							switch (yy.def) {
								case EVar(nn) if (nn == "query"):
									uq2 = true;
									return yy;								
								default:
									return yy;								
							};
						});
						if (uq2) {
							var nb4 = inlineQuery(cl4.body);
							var newFn4 = makeAST(EFn([{ args : cl4.args, guard : cl4.guard, body : nb4 }]));
							out.push(makeASTWithMeta(EMatch(lhs, makeAST(ECall(target2, "filter", [a4[0], newFn4]))), s.metadata, s.pos));
							continue;
						};					
					default:
				};			
			default:
		};	
	default:
}) {
						var ` = s.def;
						switch (enumIndex `) {
							case 8: {
								var ` = `[0];
								var ` = `[1];
								{
									var lhs = `;
									var rhs = `;
									{
										@:ast(switch (rhs.def) {
	case ERemoteCall(mod2, "filter", a3) if (a3.length == 2):
		switch (a3[1].def) {
			case EFn(clauses3) if (clauses3.length == 1):
				var cl3 = clauses3[0];
				var uq = false;
				ElixirASTTransformer.transformNode(cl3.body, function(xx:ElixirAST):ElixirAST {
					if (uq) return xx;
					switch (xx.def) {
						case EVar(nmm) if (nmm == "query"):
							uq = true;
							return xx;						
						default:
							return xx;						
					};
				});
				if (uq) {
					var nb3 = inlineQuery(cl3.body);
					var newFn3 = makeAST(EFn([{ args : cl3.args, guard : cl3.guard, body : nb3 }]));
					out.push(makeASTWithMeta(EMatch(lhs, makeAST(ERemoteCall(mod2, "filter", [a3[0], newFn3]))), s.metadata, s.pos));
					continue;
				};			
			default:
		};	
	case ECall(target2, "filter", a4) if (a4.length == 2):
		switch (a4[1].def) {
			case EFn(clauses4) if (clauses4.length == 1):
				var cl4 = clauses4[0];
				var uq2 = false;
				ElixirASTTransformer.transformNode(cl4.body, function(yy:ElixirAST):ElixirAST {
					if (uq2) return yy;
					switch (yy.def) {
						case EVar(nn) if (nn == "query"):
							uq2 = true;
							return yy;						
						default:
							return yy;						
					};
				});
				if (uq2) {
					var nb4 = inlineQuery(cl4.body);
					var newFn4 = makeAST(EFn([{ args : cl4.args, guard : cl4.guard, body : nb4 }]));
					out.push(makeASTWithMeta(EMatch(lhs, makeAST(ECall(target2, "filter", [a4[0], newFn4]))), s.metadata, s.pos));
					continue;
				};			
			default:
		};	
	default:
}) {
											var ` = rhs.def;
											switch (enumIndex `) {
												case 22: {
													var ` = `[0];
													var ` = `[1];
													var ` = `[2];
													if (` == "filter") {
														{
															var target2 = `;
															var a4 = `;
															if (a4.length == 2) {
																@:ast(switch (a4[1].def) {
	case EFn(clauses4) if (clauses4.length == 1):
		var cl4 = clauses4[0];
		var uq2 = false;
		ElixirASTTransformer.transformNode(cl4.body, function(yy:ElixirAST):ElixirAST {
			if (uq2) return yy;
			switch (yy.def) {
				case EVar(nn) if (nn == "query"):
					uq2 = true;
					return yy;				
				default:
					return yy;				
			};
		});
		if (uq2) {
			var nb4 = inlineQuery(cl4.body);
			var newFn4 = makeAST(EFn([{ args : cl4.args, guard : cl4.guard, body : nb4 }]));
			out.push(makeASTWithMeta(EMatch(lhs, makeAST(ECall(target2, "filter", [a4[0], newFn4]))), s.metadata, s.pos));
			continue;
		};	
	default:
}) {
																	var ` = a4[1].def;
																	if (enumIndex ` == 42) {
																		var ` = `[0];
																		{
																			var clauses4 = `;
																			if (clauses4.length == 1) {
																				var cl4 = clauses4[0];
																				var uq2 = [false];
																				reflaxe.elixir.ast.ElixirASTTransformer.transformNode(cl4.body, function(yy:reflaxe.elixir.ast.ElixirAST) {
																					if (uq2[0]) {
																						return yy;
																					};
																					@:ast(switch (yy.def) {
	case EVar(nn) if (nn == "query"):
		uq2 = true;
		return yy;	
	default:
		return yy;	
}) {
																						var ` = yy.def;
																						if (enumIndex ` == 38) {
																							var ` = `[0];
																							{
																								var nn = `;
																								if (nn == "query") {
																									uq2[0] = true;
																									return yy;
																								} else {
																									return yy;
																								};
																							};
																						} else {
																							return yy;
																						};
																					};
																				});
																				if (uq2[0]) {
																					var nb4 = {
																						var body = cl4.body;
																						var repl = {
																							var pos = null;
																							{def : reflaxe.elixir.ast.ElixirASTDef.ERemoteCall({
																								var pos = null;
																								{def : reflaxe.elixir.ast.ElixirASTDef.EVar("String"), metadata : {}, pos : pos};
																							}, "downcase", [{
																								var pos = null;
																								{def : reflaxe.elixir.ast.ElixirASTDef.EVar("search_query"), metadata : {}, pos : pos};
																							}]), metadata : {}, pos : pos};
																						};
																						reflaxe.elixir.ast.ElixirASTTransformer.transformNode(body, function(x:reflaxe.elixir.ast.ElixirAST) {
																							return @:ast(switch (x.def) {
	case EVar(nm) if (nm == "query"):
		repl;	
	case ERaw(code) if (code != null):
		var out = new StringBuf();
		var i = 0;
		while (i < code.length) {
			var idx = code.indexOf("query", i);
			if (idx == -1) {
				out.add(code.substr(i));
				break;
			};
			var before = idx > 0 ? code.substr(idx - 1, 1) : null;
			var afterIdx = idx + 5;
			var after = afterIdx < code.length ? code.substr(afterIdx, 1) : null;
			var isIdent = function(c:String):Bool {
				if (c == null || c.length == 0) return false;
				var ch = c.charCodeAt(0);
				return (ch >= 48 && ch <= 57) || (ch >= 65 && ch <= 90) || (ch >= 97 && ch <= 122) || c == "_";
			};
			if (!isIdent(before) && !isIdent(after)) {
				out.add(code.substr(i, idx - i));
				out.add("String.downcase(search_query)");
				i = afterIdx;
			} else {
				out.add(code.substr(i, (idx - i) + 5));
				i = idx + 5;
			};
		};
		makeASTWithMeta(ERaw(out.toString()), x.metadata, x.pos);	
	default:
		x;	
}) {
																								var ` = x.def;
																								switch (enumIndex `) {
																									case 38: {
																										var ` = `[0];
																										{
																											var nm = `;
																											if (nm == "query") {
																												repl;
																											} else {
																												x;
																											};
																										};
																									};
																									case 62: {
																										var ` = `[0];
																										{
																											var code = `;
																											if (code != null) {
																												var out = new StringBuf();
																												var i = 0;
																												while (i < code.length) {
																													var idx = code.indexOf("query", i);
																													if (idx == -1) {
																														out.add(code.substr(i, null));
																														break;
																													};
																													var before = if (idx > 0) {
																														code.substr(idx - 1, 1);
																													} else {
																														null;
																													};
																													var afterIdx = idx + 5;
																													var after = if (afterIdx < code.length) {
																														code.substr(afterIdx, 1);
																													} else {
																														null;
																													};
																													var isIdent = function(c:String) {
																														if (c == null || c.length == 0) {
																															return false;
																														};
																														var ch = c.charCodeAt(0);
																														return (ch >= 48 && ch <= 57) || (ch >= 65 && ch <= 90) || (ch >= 97 && ch <= 122) || c == "_";
																													};
																													if (! isIdent(before) && ! isIdent(after)) {
																														out.add(code.substr(i, idx - i));
																														out.add("String.downcase(search_query)");
																														i = afterIdx;
																													} else {
																														out.add(code.substr(i, (idx - i) + 5));
																														i = idx + 5;
																													};
																												};
																												{
																													var def = reflaxe.elixir.ast.ElixirASTDef.ERaw(out.toString());
																													var meta = x.metadata;
																													var pos = x.pos;
																													{def : def, metadata : meta, pos : pos};
																												};
																											} else {
																												x;
																											};
																										};
																									};
																									default: {
																										x;
																									}
																								};
																							};
																						});
																					};
																					var newFn4 = {
																						var pos = null;
																						{def : reflaxe.elixir.ast.ElixirASTDef.EFn([{args : cl4.args, guard : cl4.guard, body : nb4}]), metadata : {}, pos : pos};
																					};
																					out.push({def : reflaxe.elixir.ast.ElixirASTDef.EMatch(lhs, {
																						var pos = null;
																						{def : reflaxe.elixir.ast.ElixirASTDef.ECall(target2, "filter", [a4[0], newFn4]), metadata : {}, pos : pos};
																					}), metadata : s.metadata, pos : s.pos});
																					continue;
																				};
																			} else {};
																		};
																	} else {};
																};
															} else {};
														};
													} else {};
												};
												case 24: {
													var ` = `[0];
													var ` = `[1];
													var ` = `[2];
													if (` == "filter") {
														{
															var mod2 = `;
															var a3 = `;
															if (a3.length == 2) {
																@:ast(switch (a3[1].def) {
	case EFn(clauses3) if (clauses3.length == 1):
		var cl3 = clauses3[0];
		var uq = false;
		ElixirASTTransformer.transformNode(cl3.body, function(xx:ElixirAST):ElixirAST {
			if (uq) return xx;
			switch (xx.def) {
				case EVar(nmm) if (nmm == "query"):
					uq = true;
					return xx;				
				default:
					return xx;				
			};
		});
		if (uq) {
			var nb3 = inlineQuery(cl3.body);
			var newFn3 = makeAST(EFn([{ args : cl3.args, guard : cl3.guard, body : nb3 }]));
			out.push(makeASTWithMeta(EMatch(lhs, makeAST(ERemoteCall(mod2, "filter", [a3[0], newFn3]))), s.metadata, s.pos));
			continue;
		};	
	default:
}) {
																	var ` = a3[1].def;
																	if (enumIndex ` == 42) {
																		var ` = `[0];
																		{
																			var clauses3 = `;
																			if (clauses3.length == 1) {
																				var cl3 = clauses3[0];
																				var uq = [false];
																				reflaxe.elixir.ast.ElixirASTTransformer.transformNode(cl3.body, function(xx:reflaxe.elixir.ast.ElixirAST) {
																					if (uq[0]) {
																						return xx;
																					};
																					@:ast(switch (xx.def) {
	case EVar(nmm) if (nmm == "query"):
		uq = true;
		return xx;	
	default:
		return xx;	
}) {
																						var ` = xx.def;
																						if (enumIndex ` == 38) {
																							var ` = `[0];
																							{
																								var nmm = `;
																								if (nmm == "query") {
																									uq[0] = true;
																									return xx;
																								} else {
																									return xx;
																								};
																							};
																						} else {
																							return xx;
																						};
																					};
																				});
																				if (uq[0]) {
																					var nb3 = {
																						var body = cl3.body;
																						var repl = {
																							var pos = null;
																							{def : reflaxe.elixir.ast.ElixirASTDef.ERemoteCall({
																								var pos = null;
																								{def : reflaxe.elixir.ast.ElixirASTDef.EVar("String"), metadata : {}, pos : pos};
																							}, "downcase", [{
																								var pos = null;
																								{def : reflaxe.elixir.ast.ElixirASTDef.EVar("search_query"), metadata : {}, pos : pos};
																							}]), metadata : {}, pos : pos};
																						};
																						reflaxe.elixir.ast.ElixirASTTransformer.transformNode(body, function(x:reflaxe.elixir.ast.ElixirAST) {
																							return @:ast(switch (x.def) {
	case EVar(nm) if (nm == "query"):
		repl;	
	case ERaw(code) if (code != null):
		var out = new StringBuf();
		var i = 0;
		while (i < code.length) {
			var idx = code.indexOf("query", i);
			if (idx == -1) {
				out.add(code.substr(i));
				break;
			};
			var before = idx > 0 ? code.substr(idx - 1, 1) : null;
			var afterIdx = idx + 5;
			var after = afterIdx < code.length ? code.substr(afterIdx, 1) : null;
			var isIdent = function(c:String):Bool {
				if (c == null || c.length == 0) return false;
				var ch = c.charCodeAt(0);
				return (ch >= 48 && ch <= 57) || (ch >= 65 && ch <= 90) || (ch >= 97 && ch <= 122) || c == "_";
			};
			if (!isIdent(before) && !isIdent(after)) {
				out.add(code.substr(i, idx - i));
				out.add("String.downcase(search_query)");
				i = afterIdx;
			} else {
				out.add(code.substr(i, (idx - i) + 5));
				i = idx + 5;
			};
		};
		makeASTWithMeta(ERaw(out.toString()), x.metadata, x.pos);	
	default:
		x;	
}) {
																								var ` = x.def;
																								switch (enumIndex `) {
																									case 38: {
																										var ` = `[0];
																										{
																											var nm = `;
																											if (nm == "query") {
																												repl;
																											} else {
																												x;
																											};
																										};
																									};
																									case 62: {
																										var ` = `[0];
																										{
																											var code = `;
																											if (code != null) {
																												var out = new StringBuf();
																												var i = 0;
																												while (i < code.length) {
																													var idx = code.indexOf("query", i);
																													if (idx == -1) {
																														out.add(code.substr(i, null));
																														break;
																													};
																													var before = if (idx > 0) {
																														code.substr(idx - 1, 1);
																													} else {
																														null;
																													};
																													var afterIdx = idx + 5;
																													var after = if (afterIdx < code.length) {
																														code.substr(afterIdx, 1);
																													} else {
																														null;
																													};
																													var isIdent = function(c:String) {
																														if (c == null || c.length == 0) {
																															return false;
																														};
																														var ch = c.charCodeAt(0);
																														return (ch >= 48 && ch <= 57) || (ch >= 65 && ch <= 90) || (ch >= 97 && ch <= 122) || c == "_";
																													};
																													if (! isIdent(before) && ! isIdent(after)) {
																														out.add(code.substr(i, idx - i));
																														out.add("String.downcase(search_query)");
																														i = afterIdx;
																													} else {
																														out.add(code.substr(i, (idx - i) + 5));
																														i = idx + 5;
																													};
																												};
																												{
																													var def = reflaxe.elixir.ast.ElixirASTDef.ERaw(out.toString());
																													var meta = x.metadata;
																													var pos = x.pos;
																													{def : def, metadata : meta, pos : pos};
																												};
																											} else {
																												x;
																											};
																										};
																									};
																									default: {
																										x;
																									}
																								};
																							};
																						});
																					};
																					var newFn3 = {
																						var pos = null;
																						{def : reflaxe.elixir.ast.ElixirASTDef.EFn([{args : cl3.args, guard : cl3.guard, body : nb3}]), metadata : {}, pos : pos};
																					};
																					out.push({def : reflaxe.elixir.ast.ElixirASTDef.EMatch(lhs, {
																						var pos = null;
																						{def : reflaxe.elixir.ast.ElixirASTDef.ERemoteCall(mod2, "filter", [a3[0], newFn3]), metadata : {}, pos : pos};
																					}), metadata : s.metadata, pos : s.pos});
																					continue;
																				};
																			} else {};
																		};
																	} else {};
																};
															} else {};
														};
													} else {};
												};
												default: {}
											};
										};
									};
								};
							};
							case 22: {
								var ` = `[0];
								var ` = `[1];
								var ` = `[2];
								if (` == "filter") {
									{
										var target = `;
										var args2 = `;
										if (args2.length == 2) {
											@:ast(switch (args2[1].def) {
	case EFn(clauses) if (clauses.length == 1):
		var cl2 = clauses[0];
		var usesQ = false;
		ElixirASTTransformer.transformNode(cl2.body, function(x2:ElixirAST):ElixirAST {
			if (usesQ) return x2;
			switch (x2.def) {
				case EVar(nm2) if (nm2 == "query"):
					usesQ = true;
					return x2;				
				default:
					return x2;				
			};
		});
		if (usesQ) {
			var nb2 = inlineQuery(cl2.body);
			var newFn2 = makeAST(EFn([{ args : cl2.args, guard : cl2.guard, body : nb2 }]));
			out.push(makeASTWithMeta(ECall(target, "filter", [args2[0], newFn2]), s.metadata, s.pos));
			continue;
		};	
	default:
}) {
												var ` = args2[1].def;
												if (enumIndex ` == 42) {
													var ` = `[0];
													{
														var clauses = `;
														if (clauses.length == 1) {
															var cl2 = clauses[0];
															var usesQ = [false];
															reflaxe.elixir.ast.ElixirASTTransformer.transformNode(cl2.body, function(x2:reflaxe.elixir.ast.ElixirAST) {
																if (usesQ[0]) {
																	return x2;
																};
																@:ast(switch (x2.def) {
	case EVar(nm2) if (nm2 == "query"):
		usesQ = true;
		return x2;	
	default:
		return x2;	
}) {
																	var ` = x2.def;
																	if (enumIndex ` == 38) {
																		var ` = `[0];
																		{
																			var nm2 = `;
																			if (nm2 == "query") {
																				usesQ[0] = true;
																				return x2;
																			} else {
																				return x2;
																			};
																		};
																	} else {
																		return x2;
																	};
																};
															});
															if (usesQ[0]) {
																var nb2 = {
																	var body = cl2.body;
																	var repl = {
																		var pos = null;
																		{def : reflaxe.elixir.ast.ElixirASTDef.ERemoteCall({
																			var pos = null;
																			{def : reflaxe.elixir.ast.ElixirASTDef.EVar("String"), metadata : {}, pos : pos};
																		}, "downcase", [{
																			var pos = null;
																			{def : reflaxe.elixir.ast.ElixirASTDef.EVar("search_query"), metadata : {}, pos : pos};
																		}]), metadata : {}, pos : pos};
																	};
																	reflaxe.elixir.ast.ElixirASTTransformer.transformNode(body, function(x:reflaxe.elixir.ast.ElixirAST) {
																		return @:ast(switch (x.def) {
	case EVar(nm) if (nm == "query"):
		repl;	
	case ERaw(code) if (code != null):
		var out = new StringBuf();
		var i = 0;
		while (i < code.length) {
			var idx = code.indexOf("query", i);
			if (idx == -1) {
				out.add(code.substr(i));
				break;
			};
			var before = idx > 0 ? code.substr(idx - 1, 1) : null;
			var afterIdx = idx + 5;
			var after = afterIdx < code.length ? code.substr(afterIdx, 1) : null;
			var isIdent = function(c:String):Bool {
				if (c == null || c.length == 0) return false;
				var ch = c.charCodeAt(0);
				return (ch >= 48 && ch <= 57) || (ch >= 65 && ch <= 90) || (ch >= 97 && ch <= 122) || c == "_";
			};
			if (!isIdent(before) && !isIdent(after)) {
				out.add(code.substr(i, idx - i));
				out.add("String.downcase(search_query)");
				i = afterIdx;
			} else {
				out.add(code.substr(i, (idx - i) + 5));
				i = idx + 5;
			};
		};
		makeASTWithMeta(ERaw(out.toString()), x.metadata, x.pos);	
	default:
		x;	
}) {
																			var ` = x.def;
																			switch (enumIndex `) {
																				case 38: {
																					var ` = `[0];
																					{
																						var nm = `;
																						if (nm == "query") {
																							repl;
																						} else {
																							x;
																						};
																					};
																				};
																				case 62: {
																					var ` = `[0];
																					{
																						var code = `;
																						if (code != null) {
																							var out = new StringBuf();
																							var i = 0;
																							while (i < code.length) {
																								var idx = code.indexOf("query", i);
																								if (idx == -1) {
																									out.add(code.substr(i, null));
																									break;
																								};
																								var before = if (idx > 0) {
																									code.substr(idx - 1, 1);
																								} else {
																									null;
																								};
																								var afterIdx = idx + 5;
																								var after = if (afterIdx < code.length) {
																									code.substr(afterIdx, 1);
																								} else {
																									null;
																								};
																								var isIdent = function(c:String) {
																									if (c == null || c.length == 0) {
																										return false;
																									};
																									var ch = c.charCodeAt(0);
																									return (ch >= 48 && ch <= 57) || (ch >= 65 && ch <= 90) || (ch >= 97 && ch <= 122) || c == "_";
																								};
																								if (! isIdent(before) && ! isIdent(after)) {
																									out.add(code.substr(i, idx - i));
																									out.add("String.downcase(search_query)");
																									i = afterIdx;
																								} else {
																									out.add(code.substr(i, (idx - i) + 5));
																									i = idx + 5;
																								};
																							};
																							{
																								var def = reflaxe.elixir.ast.ElixirASTDef.ERaw(out.toString());
																								var meta = x.metadata;
																								var pos = x.pos;
																								{def : def, metadata : meta, pos : pos};
																							};
																						} else {
																							x;
																						};
																					};
																				};
																				default: {
																					x;
																				}
																			};
																		};
																	});
																};
																var newFn2 = {
																	var pos = null;
																	{def : reflaxe.elixir.ast.ElixirASTDef.EFn([{args : cl2.args, guard : cl2.guard, body : nb2}]), metadata : {}, pos : pos};
																};
																out.push({def : reflaxe.elixir.ast.ElixirASTDef.ECall(target, "filter", [args2[0], newFn2]), metadata : s.metadata, pos : s.pos});
																continue;
															};
														} else {};
													};
												} else {};
											};
										} else {};
									};
								} else {};
							};
							case 24: {
								var ` = `[0];
								var ` = `[1];
								var ` = `[2];
								if (` == "filter") {
									{
										var mod = `;
										var args = `;
										if (args.length == 2) {
											@:ast(switch (args[1].def) {
	case EFn(clauses) if (clauses.length == 1):
		var cl = clauses[0];
		var usesQuery = false;
		ElixirASTTransformer.transformNode(cl.body, function(x:ElixirAST):ElixirAST {
			if (usesQuery) return x;
			switch (x.def) {
				case EVar(nm) if (nm == "query"):
					usesQuery = true;
					return x;				
				default:
					return x;				
			};
		});
		if (usesQuery) {
			var nb = inlineQuery(cl.body);
			var newFn = makeAST(EFn([{ args : cl.args, guard : cl.guard, body : nb }]));
			out.push(makeASTWithMeta(ERemoteCall(mod, "filter", [args[0], newFn]), s.metadata, s.pos));
			continue;
		};	
	default:
}) {
												var ` = args[1].def;
												if (enumIndex ` == 42) {
													var ` = `[0];
													{
														var clauses = `;
														if (clauses.length == 1) {
															var cl = clauses[0];
															var usesQuery = [false];
															reflaxe.elixir.ast.ElixirASTTransformer.transformNode(cl.body, function(x:reflaxe.elixir.ast.ElixirAST) {
																if (usesQuery[0]) {
																	return x;
																};
																@:ast(switch (x.def) {
	case EVar(nm) if (nm == "query"):
		usesQuery = true;
		return x;	
	default:
		return x;	
}) {
																	var ` = x.def;
																	if (enumIndex ` == 38) {
																		var ` = `[0];
																		{
																			var nm = `;
																			if (nm == "query") {
																				usesQuery[0] = true;
																				return x;
																			} else {
																				return x;
																			};
																		};
																	} else {
																		return x;
																	};
																};
															});
															if (usesQuery[0]) {
																var nb = {
																	var body = cl.body;
																	var repl = {
																		var pos = null;
																		{def : reflaxe.elixir.ast.ElixirASTDef.ERemoteCall({
																			var pos = null;
																			{def : reflaxe.elixir.ast.ElixirASTDef.EVar("String"), metadata : {}, pos : pos};
																		}, "downcase", [{
																			var pos = null;
																			{def : reflaxe.elixir.ast.ElixirASTDef.EVar("search_query"), metadata : {}, pos : pos};
																		}]), metadata : {}, pos : pos};
																	};
																	reflaxe.elixir.ast.ElixirASTTransformer.transformNode(body, function(x:reflaxe.elixir.ast.ElixirAST) {
																		return @:ast(switch (x.def) {
	case EVar(nm) if (nm == "query"):
		repl;	
	case ERaw(code) if (code != null):
		var out = new StringBuf();
		var i = 0;
		while (i < code.length) {
			var idx = code.indexOf("query", i);
			if (idx == -1) {
				out.add(code.substr(i));
				break;
			};
			var before = idx > 0 ? code.substr(idx - 1, 1) : null;
			var afterIdx = idx + 5;
			var after = afterIdx < code.length ? code.substr(afterIdx, 1) : null;
			var isIdent = function(c:String):Bool {
				if (c == null || c.length == 0) return false;
				var ch = c.charCodeAt(0);
				return (ch >= 48 && ch <= 57) || (ch >= 65 && ch <= 90) || (ch >= 97 && ch <= 122) || c == "_";
			};
			if (!isIdent(before) && !isIdent(after)) {
				out.add(code.substr(i, idx - i));
				out.add("String.downcase(search_query)");
				i = afterIdx;
			} else {
				out.add(code.substr(i, (idx - i) + 5));
				i = idx + 5;
			};
		};
		makeASTWithMeta(ERaw(out.toString()), x.metadata, x.pos);	
	default:
		x;	
}) {
																			var ` = x.def;
																			switch (enumIndex `) {
																				case 38: {
																					var ` = `[0];
																					{
																						var nm = `;
																						if (nm == "query") {
																							repl;
																						} else {
																							x;
																						};
																					};
																				};
																				case 62: {
																					var ` = `[0];
																					{
																						var code = `;
																						if (code != null) {
																							var out = new StringBuf();
																							var i = 0;
																							while (i < code.length) {
																								var idx = code.indexOf("query", i);
																								if (idx == -1) {
																									out.add(code.substr(i, null));
																									break;
																								};
																								var before = if (idx > 0) {
																									code.substr(idx - 1, 1);
																								} else {
																									null;
																								};
																								var afterIdx = idx + 5;
																								var after = if (afterIdx < code.length) {
																									code.substr(afterIdx, 1);
																								} else {
																									null;
																								};
																								var isIdent = function(c:String) {
																									if (c == null || c.length == 0) {
																										return false;
																									};
																									var ch = c.charCodeAt(0);
																									return (ch >= 48 && ch <= 57) || (ch >= 65 && ch <= 90) || (ch >= 97 && ch <= 122) || c == "_";
																								};
																								if (! isIdent(before) && ! isIdent(after)) {
																									out.add(code.substr(i, idx - i));
																									out.add("String.downcase(search_query)");
																									i = afterIdx;
																								} else {
																									out.add(code.substr(i, (idx - i) + 5));
																									i = idx + 5;
																								};
																							};
																							{
																								var def = reflaxe.elixir.ast.ElixirASTDef.ERaw(out.toString());
																								var meta = x.metadata;
																								var pos = x.pos;
																								{def : def, metadata : meta, pos : pos};
																							};
																						} else {
																							x;
																						};
																					};
																				};
																				default: {
																					x;
																				}
																			};
																		};
																	});
																};
																var newFn = {
																	var pos = null;
																	{def : reflaxe.elixir.ast.ElixirASTDef.EFn([{args : cl.args, guard : cl.guard, body : nb}]), metadata : {}, pos : pos};
																};
																out.push({def : reflaxe.elixir.ast.ElixirASTDef.ERemoteCall(mod, "filter", [args[0], newFn]), metadata : s.metadata, pos : s.pos});
																continue;
															};
														} else {};
													};
												} else {};
											};
										} else {};
									};
								} else {};
							};
							default: {}
						};
					};
				};
				out.push(s);
			};
		};
		return out;
	}
}