class reflaxe.elixir.ast.transformers.OptionWrapTransforms {

	public static function optionWrapParseFunctionsPass(ast:reflaxe.elixir.ast.ElixirAST) {
		{};
		{};
		var wrapBlockLastExpr = function(b:reflaxe.elixir.ast.ElixirAST) {
			return @:ast(switch (b.def) {
	case EBlock(stmts) if (stmts.length > 0):
		var out = stmts.copy();
		var last = out.pop();
		out.push(wrapValueIfNeeded(last));
		makeASTWithMeta(EBlock(out), b.metadata, b.pos);	
	default:
		b;	
}) {
				var ` = b.def;
				if (enumIndex ` == 53) {
					var ` = `[0];
					{
						var stmts = `;
						if (stmts.length > 0) {
							var out = stmts.copy();
							var last = out.pop();
							out.push(if (@:ast(switch (val.def) {
	case ETuple(elements) if (elements.length >= 1):
		switch (elements[0].def) {
			case EAtom(tag) if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none"):
				true;			
			default:
				false;			
		};	
	default:
		false;	
}) {
								var ` = last.def;
								if (enumIndex ` == 16) {
									var ` = `[0];
									{
										var elements = `;
										if (elements.length >= 1) {
											@:ast(switch (elements[0].def) {
	case EAtom(tag) if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none"):
		true;	
	default:
		false;	
}) {
												var ` = elements[0].def;
												if (enumIndex ` == 31) {
													var ` = `[0];
													{
														var tag = `;
														if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none") {
															true;
														} else {
															false;
														};
													};
												} else {
													false;
												};
											};
										} else {
											false;
										};
									};
								} else {
									false;
								};
							}) {
								last;
							} else {
								@:ast(switch (val.def) {
	case EAtom(atom) if (atom == "none" || atom == ":none"):
		makeAST(ETuple([makeAST(EAtom("none"))]));	
	default:
		makeAST(ETuple([makeAST(EAtom("some")), val]));	
}) {
									var ` = last.def;
									if (enumIndex ` == 31) {
										var ` = `[0];
										{
											var atom = `;
											if (atom == "none" || atom == ":none") {
												{
													var def = reflaxe.elixir.ast.ElixirASTDef.ETuple([{
														var def = reflaxe.elixir.ast.ElixirASTDef.EAtom(@:implicitCast {
															var this;
															this = reflaxe.elixir.ast.NameUtils.toSnakeCase("none");
															cast this;
														});
														var pos = null;
														{def : def, metadata : {}, pos : pos};
													}]);
													var pos = null;
													{def : def, metadata : {}, pos : pos};
												};
											} else {
												{
													var def = reflaxe.elixir.ast.ElixirASTDef.ETuple([{
														var def = reflaxe.elixir.ast.ElixirASTDef.EAtom(@:implicitCast {
															var this;
															this = reflaxe.elixir.ast.NameUtils.toSnakeCase("some");
															cast this;
														});
														var pos = null;
														{def : def, metadata : {}, pos : pos};
													}, last]);
													var pos = null;
													{def : def, metadata : {}, pos : pos};
												};
											};
										};
									} else {
										{
											var def = reflaxe.elixir.ast.ElixirASTDef.ETuple([{
												var def = reflaxe.elixir.ast.ElixirASTDef.EAtom(@:implicitCast {
													var this;
													this = reflaxe.elixir.ast.NameUtils.toSnakeCase("some");
													cast this;
												});
												var pos = null;
												{def : def, metadata : {}, pos : pos};
											}, last]);
											var pos = null;
											{def : def, metadata : {}, pos : pos};
										};
									};
								};
							});
							{def : reflaxe.elixir.ast.ElixirASTDef.EBlock(out), metadata : b.metadata, pos : b.pos};
						} else {
							b;
						};
					};
				} else {
					b;
				};
			};
		};
		var wrapCase = function(c:reflaxe.elixir.ast.ElixirAST) {
			return reflaxe.elixir.ast.ElixirASTTransformer.transformNode(c, function(n:reflaxe.elixir.ast.ElixirAST) {
				return @:ast(switch (n.def) {
	case EMatch(pat, { def : ECase(target, clauses) }):
		var wrapped = [];
		for (cl  in  clauses) {
			var b = cl.body;
			var nb = isAlreadyOption(b) ? b : wrapValueIfNeeded(b);
			wrapped.push({ pattern : cl.pattern, guard : cl.guard, body : nb });
		};
		makeASTWithMeta(EMatch(pat, makeAST(ECase(target, wrapped))), n.metadata, n.pos);	
	case ECase(target, clauses):
		var wrapped = [];
		for (cl  in  clauses) {
			var body = cl.body;
			var newBody = isAlreadyOption(body) ? body : switch (body.def) {
				case EBlock(_):
					wrapBlockLastExpr(body);				
				default:
					wrapValueIfNeeded(body);				
			};
			wrapped.push({ pattern : cl.pattern, guard : cl.guard, body : newBody });
		};
		makeASTWithMeta(ECase(target, wrapped), n.metadata, n.pos);	
	case EIf(cond, thenB, elseB):
		function wrapBranch(b:ElixirAST):ElixirAST {
			return isAlreadyOption(b) ? b : switch (b.def) {
				case EBlock(_):
					wrapBlockLastExpr(b);				
				default:
					wrapValueIfNeeded(b);				
			};
		};
		var newThen = wrapBranch(thenB);
		var newElse = elseB != null ? wrapBranch(elseB) : elseB;
		makeASTWithMeta(EIf(cond, newThen, newElse), n.metadata, n.pos);	
	default:
		n;	
}) {
					var ` = n.def;
					switch (enumIndex `) {
						case 6: {
							var ` = `[0];
							var ` = `[1];
							{
								var target = `;
								var clauses = `;
								{
									var wrapped = [];
									{
										var ` = 0;
										while (` < clauses.length) {
											var cl = clauses[`];
											++ `;
											var body = cl.body;
											var newBody = if (@:ast(switch (val.def) {
	case ETuple(elements) if (elements.length >= 1):
		switch (elements[0].def) {
			case EAtom(tag) if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none"):
				true;			
			default:
				false;			
		};	
	default:
		false;	
}) {
												var ` = body.def;
												if (enumIndex ` == 16) {
													var ` = `[0];
													{
														var elements = `;
														if (elements.length >= 1) {
															@:ast(switch (elements[0].def) {
	case EAtom(tag) if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none"):
		true;	
	default:
		false;	
}) {
																var ` = elements[0].def;
																if (enumIndex ` == 31) {
																	var ` = `[0];
																	{
																		var tag = `;
																		if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none") {
																			true;
																		} else {
																			false;
																		};
																	};
																} else {
																	false;
																};
															};
														} else {
															false;
														};
													};
												} else {
													false;
												};
											}) {
												body;
											} else {
												@:ast(switch (body.def) {
	case EBlock(_):
		wrapBlockLastExpr(body);	
	default:
		wrapValueIfNeeded(body);	
}) {
													var ` = body.def;
													if (enumIndex ` == 53) {
														var ` = `[0];
														{
															wrapBlockLastExpr(body);
														};
													} else {
														if (@:ast(switch (val.def) {
	case ETuple(elements) if (elements.length >= 1):
		switch (elements[0].def) {
			case EAtom(tag) if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none"):
				true;			
			default:
				false;			
		};	
	default:
		false;	
}) {
															var ` = body.def;
															if (enumIndex ` == 16) {
																var ` = `[0];
																{
																	var elements = `;
																	if (elements.length >= 1) {
																		@:ast(switch (elements[0].def) {
	case EAtom(tag) if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none"):
		true;	
	default:
		false;	
}) {
																			var ` = elements[0].def;
																			if (enumIndex ` == 31) {
																				var ` = `[0];
																				{
																					var tag = `;
																					if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none") {
																						true;
																					} else {
																						false;
																					};
																				};
																			} else {
																				false;
																			};
																		};
																	} else {
																		false;
																	};
																};
															} else {
																false;
															};
														}) {
															body;
														} else {
															@:ast(switch (val.def) {
	case EAtom(atom) if (atom == "none" || atom == ":none"):
		makeAST(ETuple([makeAST(EAtom("none"))]));	
	default:
		makeAST(ETuple([makeAST(EAtom("some")), val]));	
}) {
																var ` = body.def;
																if (enumIndex ` == 31) {
																	var ` = `[0];
																	{
																		var atom = `;
																		if (atom == "none" || atom == ":none") {
																			{
																				var def = reflaxe.elixir.ast.ElixirASTDef.ETuple([{
																					var def = reflaxe.elixir.ast.ElixirASTDef.EAtom(@:implicitCast {
																						var this;
																						this = reflaxe.elixir.ast.NameUtils.toSnakeCase("none");
																						cast this;
																					});
																					var pos = null;
																					{def : def, metadata : {}, pos : pos};
																				}]);
																				var pos = null;
																				{def : def, metadata : {}, pos : pos};
																			};
																		} else {
																			{
																				var def = reflaxe.elixir.ast.ElixirASTDef.ETuple([{
																					var def = reflaxe.elixir.ast.ElixirASTDef.EAtom(@:implicitCast {
																						var this;
																						this = reflaxe.elixir.ast.NameUtils.toSnakeCase("some");
																						cast this;
																					});
																					var pos = null;
																					{def : def, metadata : {}, pos : pos};
																				}, body]);
																				var pos = null;
																				{def : def, metadata : {}, pos : pos};
																			};
																		};
																	};
																} else {
																	{
																		var def = reflaxe.elixir.ast.ElixirASTDef.ETuple([{
																			var def = reflaxe.elixir.ast.ElixirASTDef.EAtom(@:implicitCast {
																				var this;
																				this = reflaxe.elixir.ast.NameUtils.toSnakeCase("some");
																				cast this;
																			});
																			var pos = null;
																			{def : def, metadata : {}, pos : pos};
																		}, body]);
																		var pos = null;
																		{def : def, metadata : {}, pos : pos};
																	};
																};
															};
														};
													};
												};
											};
											wrapped.push({pattern : cl.pattern, guard : cl.guard, body : newBody});
										};
									};
									{def : reflaxe.elixir.ast.ElixirASTDef.ECase(target, wrapped), metadata : n.metadata, pos : n.pos};
								};
							};
						};
						case 8: {
							var ` = `[0];
							var ` = `[1];
							{
								var ` = `.def;
								var ` = `.metadata;
								var ` = `.pos;
								if (enumIndex ` == 6) {
									var ` = `[0];
									var ` = `[1];
									{
										var target = `;
										var clauses = `;
										var pat = `;
										{
											var wrapped = [];
											{
												var ` = 0;
												while (` < clauses.length) {
													var cl = clauses[`];
													++ `;
													var b = cl.body;
													var nb = if (@:ast(switch (val.def) {
	case ETuple(elements) if (elements.length >= 1):
		switch (elements[0].def) {
			case EAtom(tag) if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none"):
				true;			
			default:
				false;			
		};	
	default:
		false;	
}) {
														var ` = b.def;
														if (enumIndex ` == 16) {
															var ` = `[0];
															{
																var elements = `;
																if (elements.length >= 1) {
																	@:ast(switch (elements[0].def) {
	case EAtom(tag) if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none"):
		true;	
	default:
		false;	
}) {
																		var ` = elements[0].def;
																		if (enumIndex ` == 31) {
																			var ` = `[0];
																			{
																				var tag = `;
																				if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none") {
																					true;
																				} else {
																					false;
																				};
																			};
																		} else {
																			false;
																		};
																	};
																} else {
																	false;
																};
															};
														} else {
															false;
														};
													}) {
														b;
													} else {
														if (@:ast(switch (val.def) {
	case ETuple(elements) if (elements.length >= 1):
		switch (elements[0].def) {
			case EAtom(tag) if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none"):
				true;			
			default:
				false;			
		};	
	default:
		false;	
}) {
															var ` = b.def;
															if (enumIndex ` == 16) {
																var ` = `[0];
																{
																	var elements = `;
																	if (elements.length >= 1) {
																		@:ast(switch (elements[0].def) {
	case EAtom(tag) if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none"):
		true;	
	default:
		false;	
}) {
																			var ` = elements[0].def;
																			if (enumIndex ` == 31) {
																				var ` = `[0];
																				{
																					var tag = `;
																					if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none") {
																						true;
																					} else {
																						false;
																					};
																				};
																			} else {
																				false;
																			};
																		};
																	} else {
																		false;
																	};
																};
															} else {
																false;
															};
														}) {
															b;
														} else {
															@:ast(switch (val.def) {
	case EAtom(atom) if (atom == "none" || atom == ":none"):
		makeAST(ETuple([makeAST(EAtom("none"))]));	
	default:
		makeAST(ETuple([makeAST(EAtom("some")), val]));	
}) {
																var ` = b.def;
																if (enumIndex ` == 31) {
																	var ` = `[0];
																	{
																		var atom = `;
																		if (atom == "none" || atom == ":none") {
																			{
																				var def = reflaxe.elixir.ast.ElixirASTDef.ETuple([{
																					var def = reflaxe.elixir.ast.ElixirASTDef.EAtom(@:implicitCast {
																						var this;
																						this = reflaxe.elixir.ast.NameUtils.toSnakeCase("none");
																						cast this;
																					});
																					var pos = null;
																					{def : def, metadata : {}, pos : pos};
																				}]);
																				var pos = null;
																				{def : def, metadata : {}, pos : pos};
																			};
																		} else {
																			{
																				var def = reflaxe.elixir.ast.ElixirASTDef.ETuple([{
																					var def = reflaxe.elixir.ast.ElixirASTDef.EAtom(@:implicitCast {
																						var this;
																						this = reflaxe.elixir.ast.NameUtils.toSnakeCase("some");
																						cast this;
																					});
																					var pos = null;
																					{def : def, metadata : {}, pos : pos};
																				}, b]);
																				var pos = null;
																				{def : def, metadata : {}, pos : pos};
																			};
																		};
																	};
																} else {
																	{
																		var def = reflaxe.elixir.ast.ElixirASTDef.ETuple([{
																			var def = reflaxe.elixir.ast.ElixirASTDef.EAtom(@:implicitCast {
																				var this;
																				this = reflaxe.elixir.ast.NameUtils.toSnakeCase("some");
																				cast this;
																			});
																			var pos = null;
																			{def : def, metadata : {}, pos : pos};
																		}, b]);
																		var pos = null;
																		{def : def, metadata : {}, pos : pos};
																	};
																};
															};
														};
													};
													wrapped.push({pattern : cl.pattern, guard : cl.guard, body : nb});
												};
											};
											{def : reflaxe.elixir.ast.ElixirASTDef.EMatch(pat, {
												var pos = null;
												{def : reflaxe.elixir.ast.ElixirASTDef.ECase(target, wrapped), metadata : {}, pos : pos};
											}), metadata : n.metadata, pos : n.pos};
										};
									};
								} else {
									n;
								};
							};
						};
						case 10: {
							var ` = `[0];
							var ` = `[1];
							var ` = `[2];
							{
								var cond = `;
								var thenB = `;
								var elseB = `;
								{
									var wrapBranch = function(b:reflaxe.elixir.ast.ElixirAST) {
										return if (@:ast(switch (val.def) {
	case ETuple(elements) if (elements.length >= 1):
		switch (elements[0].def) {
			case EAtom(tag) if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none"):
				true;			
			default:
				false;			
		};	
	default:
		false;	
}) {
											var ` = b.def;
											if (enumIndex ` == 16) {
												var ` = `[0];
												{
													var elements = `;
													if (elements.length >= 1) {
														@:ast(switch (elements[0].def) {
	case EAtom(tag) if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none"):
		true;	
	default:
		false;	
}) {
															var ` = elements[0].def;
															if (enumIndex ` == 31) {
																var ` = `[0];
																{
																	var tag = `;
																	if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none") {
																		true;
																	} else {
																		false;
																	};
																};
															} else {
																false;
															};
														};
													} else {
														false;
													};
												};
											} else {
												false;
											};
										}) {
											b;
										} else {
											@:ast(switch (b.def) {
	case EBlock(_):
		wrapBlockLastExpr(b);	
	default:
		wrapValueIfNeeded(b);	
}) {
												var ` = b.def;
												if (enumIndex ` == 53) {
													var ` = `[0];
													{
														wrapBlockLastExpr(b);
													};
												} else {
													if (@:ast(switch (val.def) {
	case ETuple(elements) if (elements.length >= 1):
		switch (elements[0].def) {
			case EAtom(tag) if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none"):
				true;			
			default:
				false;			
		};	
	default:
		false;	
}) {
														var ` = b.def;
														if (enumIndex ` == 16) {
															var ` = `[0];
															{
																var elements = `;
																if (elements.length >= 1) {
																	@:ast(switch (elements[0].def) {
	case EAtom(tag) if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none"):
		true;	
	default:
		false;	
}) {
																		var ` = elements[0].def;
																		if (enumIndex ` == 31) {
																			var ` = `[0];
																			{
																				var tag = `;
																				if (tag == "some" || tag == ":some" || tag == "none" || tag == ":none") {
																					true;
																				} else {
																					false;
																				};
																			};
																		} else {
																			false;
																		};
																	};
																} else {
																	false;
																};
															};
														} else {
															false;
														};
													}) {
														b;
													} else {
														@:ast(switch (val.def) {
	case EAtom(atom) if (atom == "none" || atom == ":none"):
		makeAST(ETuple([makeAST(EAtom("none"))]));	
	default:
		makeAST(ETuple([makeAST(EAtom("some")), val]));	
}) {
															var ` = b.def;
															if (enumIndex ` == 31) {
																var ` = `[0];
																{
																	var atom = `;
																	if (atom == "none" || atom == ":none") {
																		{
																			var def = reflaxe.elixir.ast.ElixirASTDef.ETuple([{
																				var def = reflaxe.elixir.ast.ElixirASTDef.EAtom(@:implicitCast {
																					var this;
																					this = reflaxe.elixir.ast.NameUtils.toSnakeCase("none");
																					cast this;
																				});
																				var pos = null;
																				{def : def, metadata : {}, pos : pos};
																			}]);
																			var pos = null;
																			{def : def, metadata : {}, pos : pos};
																		};
																	} else {
																		{
																			var def = reflaxe.elixir.ast.ElixirASTDef.ETuple([{
																				var def = reflaxe.elixir.ast.ElixirASTDef.EAtom(@:implicitCast {
																					var this;
																					this = reflaxe.elixir.ast.NameUtils.toSnakeCase("some");
																					cast this;
																				});
																				var pos = null;
																				{def : def, metadata : {}, pos : pos};
																			}, b]);
																			var pos = null;
																			{def : def, metadata : {}, pos : pos};
																		};
																	};
																};
															} else {
																{
																	var def = reflaxe.elixir.ast.ElixirASTDef.ETuple([{
																		var def = reflaxe.elixir.ast.ElixirASTDef.EAtom(@:implicitCast {
																			var this;
																			this = reflaxe.elixir.ast.NameUtils.toSnakeCase("some");
																			cast this;
																		});
																		var pos = null;
																		{def : def, metadata : {}, pos : pos};
																	}, b]);
																	var pos = null;
																	{def : def, metadata : {}, pos : pos};
																};
															};
														};
													};
												};
											};
										};
									};
									var newThen = wrapBranch(thenB);
									var newElse = if (elseB != null) {
										wrapBranch(elseB);
									} else {
										elseB;
									};
									{def : reflaxe.elixir.ast.ElixirASTDef.EIf(cond, newThen, newElse), metadata : n.metadata, pos : n.pos};
								};
							};
						};
						default: {
							n;
						}
					};
				};
			});
		};
		var processBody = function(body:reflaxe.elixir.ast.ElixirAST) {
			return @:ast(switch (body.def) {
	case EBlock(stmts):
		var out:Array<ElixirAST> = [];
		for (s  in  stmts) out.push(wrapCase(s));
		makeASTWithMeta(EBlock(out), body.metadata, body.pos);	
	default:
		wrapCase(body);	
}) {
				var ` = body.def;
				if (enumIndex ` == 53) {
					var ` = `[0];
					{
						var stmts = `;
						{
							var out = [];
							{
								var ` = 0;
								while (` < stmts.length) {
									var s = stmts[`];
									++ `;
									out.push(wrapCase(s));
								};
							};
							{def : reflaxe.elixir.ast.ElixirASTDef.EBlock(out), metadata : body.metadata, pos : body.pos};
						};
					};
				} else {
					wrapCase(body);
				};
			};
		};
		return reflaxe.elixir.ast.ElixirASTTransformer.transformNode(ast, function(n:reflaxe.elixir.ast.ElixirAST) {
			return @:ast(switch (n.def) {
	case EDef(name, args, guards, body) if (name != null && StringTools.startsWith(name, "parse_")):
		makeASTWithMeta(EDef(name, args, guards, processBody(body)), n.metadata, n.pos);	
	case EDefp(name, args, guards, body) if (name != null && StringTools.startsWith(name, "parse_")):
		makeASTWithMeta(EDefp(name, args, guards, processBody(body)), n.metadata, n.pos);	
	default:
		n;	
}) {
				var ` = n.def;
				switch (enumIndex `) {
					case 2: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						var ` = `[3];
						{
							var name = `;
							var args = `;
							var guards = `;
							var body = `;
							if (name != null && StringTools.startsWith(name, "parse_")) {
								{
									var def = reflaxe.elixir.ast.ElixirASTDef.EDef(name, args, guards, processBody(body));
									var meta = n.metadata;
									var pos = n.pos;
									{def : def, metadata : meta, pos : pos};
								};
							} else {
								n;
							};
						};
					};
					case 3: {
						var ` = `[0];
						var ` = `[1];
						var ` = `[2];
						var ` = `[3];
						{
							var name = `;
							var args = `;
							var guards = `;
							var body = `;
							if (name != null && StringTools.startsWith(name, "parse_")) {
								{
									var def = reflaxe.elixir.ast.ElixirASTDef.EDefp(name, args, guards, processBody(body));
									var meta = n.metadata;
									var pos = n.pos;
									{def : def, metadata : meta, pos : pos};
								};
							} else {
								n;
							};
						};
					};
					default: {
						n;
					}
				};
			};
		});
	}
}