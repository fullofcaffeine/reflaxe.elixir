class reflaxe.elixir.ast.transformers.DropTempNilAssignTransforms {

	public static function pass(ast:reflaxe.elixir.ast.ElixirAST) {
		return reflaxe.elixir.ast.ElixirASTTransformer.transformNode(ast, function(n:reflaxe.elixir.ast.ElixirAST) {
			return @:ast(switch (n.def) {
	case EBlock(stmts):
		makeASTWithMeta(EBlock(filter(stmts)), n.metadata, n.pos);	
	case EDo(stmts2):
		makeASTWithMeta(EDo(filter(stmts2)), n.metadata, n.pos);	
	case EFn(clauses):
		var newClauses = [];
		for (cl  in  clauses) {
			var b = cl.body;
			var nb = switch (b.def) {
				case EBlock(ss):
					makeASTWithMeta(EBlock(filter(ss)), b.metadata, b.pos);				
				case EDo(ss2):
					makeASTWithMeta(EDo(filter(ss2)), b.metadata, b.pos);				
				default:
					b;				
			};
			newClauses.push({ args : cl.args, guard : cl.guard, body : nb });
		};
		makeASTWithMeta(EFn(newClauses), n.metadata, n.pos);	
	default:
		n;	
}) {
				var ` = n.def;
				switch (enumIndex `) {
					case 42: {
						var ` = `[0];
						{
							var clauses = `;
							{
								var newClauses = [];
								{
									var ` = 0;
									while (` < clauses.length) {
										var cl = clauses[`];
										++ `;
										var b = cl.body;
										var nb = @:ast(switch (b.def) {
	case EBlock(ss):
		makeASTWithMeta(EBlock(filter(ss)), b.metadata, b.pos);	
	case EDo(ss2):
		makeASTWithMeta(EDo(filter(ss2)), b.metadata, b.pos);	
	default:
		b;	
}) {
											var ` = b.def;
											switch (enumIndex `) {
												case 53: {
													var ` = `[0];
													{
														var ss = `;
														{
															{
																var def = reflaxe.elixir.ast.ElixirASTDef.EBlock(reflaxe.elixir.ast.transformers.DropTempNilAssignTransforms.filter(ss));
																var meta = b.metadata;
																var pos = b.pos;
																{def : def, metadata : meta, pos : pos};
															};
														};
													};
												};
												case 55: {
													var ` = `[0];
													{
														var ss2 = `;
														{
															{
																var def = reflaxe.elixir.ast.ElixirASTDef.EDo(reflaxe.elixir.ast.transformers.DropTempNilAssignTransforms.filter(ss2));
																var meta = b.metadata;
																var pos = b.pos;
																{def : def, metadata : meta, pos : pos};
															};
														};
													};
												};
												default: {
													b;
												}
											};
										};
										newClauses.push({args : cl.args, guard : cl.guard, body : nb});
									};
								};
								{def : reflaxe.elixir.ast.ElixirASTDef.EFn(newClauses), metadata : n.metadata, pos : n.pos};
							};
						};
					};
					case 53: {
						var ` = `[0];
						{
							var stmts = `;
							{
								{
									var def = reflaxe.elixir.ast.ElixirASTDef.EBlock(reflaxe.elixir.ast.transformers.DropTempNilAssignTransforms.filter(stmts));
									var meta = n.metadata;
									var pos = n.pos;
									{def : def, metadata : meta, pos : pos};
								};
							};
						};
					};
					case 55: {
						var ` = `[0];
						{
							var stmts2 = `;
							{
								{
									var def = reflaxe.elixir.ast.ElixirASTDef.EDo(reflaxe.elixir.ast.transformers.DropTempNilAssignTransforms.filter(stmts2));
									var meta = n.metadata;
									var pos = n.pos;
									{def : def, metadata : meta, pos : pos};
								};
							};
						};
					};
					default: {
						n;
					}
				};
			};
		});
	}

	static function filter(stmts:Array<reflaxe.elixir.ast.ElixirAST>) {
		var out = [];
		{
			var ` = 0;
			while (` < stmts.length) {
				var s = stmts[`];
				++ `;
				@:ast(switch (s.def) {
	case EBinary(Match, left, rhs):
		var isTemp = switch (left.def) {
			case EVar(nm):
				isTempName(nm);			
			default:
				false;			
		};
		var isNil = switch (rhs.def) {
			case ENil:
				true;			
			default:
				false;			
		};
		if (!(isTemp && isNil)) out.push(s);	
	case EMatch(pat, rhs2):
		var isTemp2 = switch (pat) {
			case PVar(n2):
				isTempName(n2);			
			default:
				false;			
		};
		var isNil2 = switch (rhs2.def) {
			case ENil:
				true;			
			default:
				false;			
		};
		if (!(isTemp2 && isNil2)) out.push(s);	
	default:
		out.push(s);	
}) {
					var ` = s.def;
					switch (enumIndex `) {
						case 8: {
							var ` = `[0];
							var ` = `[1];
							{
								var pat = `;
								var rhs2 = `;
								{
									var isTemp2 = @:ast(switch (pat) {
	case PVar(n2):
		isTempName(n2);	
	default:
		false;	
}) if (enumIndex pat == 0) {
										var ` = pat[0];
										{
											var n2 = `;
											{
												reflaxe.elixir.ast.transformers.DropTempNilAssignTransforms.isTempName(n2);
											};
										};
									} else {
										false;
									};
									var isNil2 = @:ast(switch (rhs2.def) {
	case ENil:
		true;	
	default:
		false;	
}) {
										var ` = rhs2.def;
										if (enumIndex ` == 36) {
											{
												true;
											};
										} else {
											false;
										};
									};
									if (! (isTemp2 && isNil2)) {
										out.push(s);
									};
								};
							};
						};
						case 26: {
							var ` = `[0];
							var ` = `[1];
							var ` = `[2];
							if (enumIndex ` == 27) {
								{
									var left = `;
									var rhs = `;
									{
										var isTemp = @:ast(switch (left.def) {
	case EVar(nm):
		isTempName(nm);	
	default:
		false;	
}) {
											var ` = left.def;
											if (enumIndex ` == 38) {
												var ` = `[0];
												{
													var nm = `;
													{
														reflaxe.elixir.ast.transformers.DropTempNilAssignTransforms.isTempName(nm);
													};
												};
											} else {
												false;
											};
										};
										var isNil = @:ast(switch (rhs.def) {
	case ENil:
		true;	
	default:
		false;	
}) {
											var ` = rhs.def;
											if (enumIndex ` == 36) {
												{
													true;
												};
											} else {
												false;
											};
										};
										if (! (isTemp && isNil)) {
											out.push(s);
										};
									};
								};
							} else {
								out.push(s);
							};
						};
						default: {
							out.push(s);
						}
					};
				};
			};
		};
		return out;
	}

	static function isTempName(nm:String) {
		if (nm == null) {
			return false;
		};
		if (nm.indexOf("this", null) == 0) {
			return true;
		};
		if (nm.indexOf("_this", null) == 0) {
			return true;
		};
		return false;
	}
}