@:used
class Main {

	static function parseMessage[Function:(msg : String) -> Option<Message>]
		[Arg:String] [Local msg(34260):String]
		[Block:Dynamic]
			[Return:Dynamic]
				[Meta:Option<Message>]
					:ast(switch (msg) {
	case "create":
		Some(TodoCreated({ id : 1, title : "Test" }));	
	case "update":
		Some(TodoUpdated({ id : 1, title : "Updated" }));	
	case "delete":
		Some(TodoDeleted(1));	
	case "alert":
		Some(SystemAlert("Warning"));	
	default:
		None;	
})
					[Switch:Option<Message>]
						[Parenthesis:String] [Local msg(34260):String:String]
						[Case:Option<Message>]
							[Const:String] "alert"
							[Call:Option<Message>]
								[Field:(value : Message) -> Option<Message>]
									[TypeExpr Option:Enum<Option><Unknown<0>>]
									[FEnum:(value : Message) -> Option<Message>]
										Option
										Some
								[Call:Message]
									[Field:(message : String) -> Message]
										[TypeExpr Message:Enum<Message>]
										[FEnum:(message : String) -> Message]
											Message
											SystemAlert
									[Const:String] "Warning"
						[Case:Option<Message>]
							[Const:String] "create"
							[Call:Option<Message>]
								[Field:(value : Message) -> Option<Message>]
									[TypeExpr Option:Enum<Option><Unknown<1>>]
									[FEnum:(value : Message) -> Option<Message>]
										Option
										Some
								[Call:Message]
									[Field:(todo : Dynamic) -> Message]
										[TypeExpr Message:Enum<Message>]
										[FEnum:(todo : Dynamic) -> Message]
											Message
											TodoCreated
									[ObjectDecl:{ title : String, id : Int }]
										id: [Const:Int] 1
										title: [Const:String] "Test"
						[Case:Option<Message>]
							[Const:String] "delete"
							[Call:Option<Message>]
								[Field:(value : Message) -> Option<Message>]
									[TypeExpr Option:Enum<Option><Unknown<2>>]
									[FEnum:(value : Message) -> Option<Message>]
										Option
										Some
								[Call:Message]
									[Field:(id : Int) -> Message]
										[TypeExpr Message:Enum<Message>]
										[FEnum:(id : Int) -> Message]
											Message
											TodoDeleted
									[Const:Int] 1
						[Case:Option<Message>]
							[Const:String] "update"
							[Call:Option<Message>]
								[Field:(value : Message) -> Option<Message>]
									[TypeExpr Option:Enum<Option><Unknown<3>>]
									[FEnum:(value : Message) -> Option<Message>]
										Option
										Some
								[Call:Message]
									[Field:(todo : Dynamic) -> Message]
										[TypeExpr Message:Enum<Message>]
										[FEnum:(todo : Dynamic) -> Message]
											Message
											TodoUpdated
									[ObjectDecl:{ title : String, id : Int }]
										id: [Const:Int] 1
										title: [Const:String] "Updated"
						[Default:Option<Message>]
							[Field:Option<Message>]
								[TypeExpr Option:Enum<Option><Unknown<4>>]
								[FEnum:Option<Message>]
									Option
									None

	public static function main[Function:() -> Void]
		[Block:Void]
			[Var msg(34261):String] [Const:String] "create"
			[Meta:Void]
				:ast(switch (parseMessage(msg)) {
	case Some(parsedMsg):
		switch (parsedMsg) {
			case TodoCreated(todo):
				trace("Todo created: " + todo.title);			
			case TodoUpdated(todo):
				trace("Todo updated: " + todo.title);			
			case TodoDeleted(id):
				trace("Todo deleted: " + id);			
			case SystemAlert(message):
				trace("Alert: " + message);			
		};	
	case None:
		trace("No message parsed");	
})
				[Block:Void]
					[Var _g(34362):Option<Message>]
						[Call:Option<Message>]
							[Field:(msg : String) -> Option<Message>]
								[TypeExpr Main:Class<Main>]
								[FStatic:(msg : String) -> Option<Message>]
									Main
									parseMessage:(msg : String) -> Option<Message>
							[Local msg(34261):String:String]
					[Switch:Void]
						[Parenthesis:Int]
							[Meta:Int]
								:exhaustive
								[EnumIndex:Int] [Local _g(34362):Option<Message>:Option<Message>]
						[Case:Void]
							[Const:Int] 0
							[Block:Void]
								[Var _g(34363):Message]
									[EnumParameter:Message]
										[Local _g(34362):Option<Message>:Option<Message>]
										Some
										0
								[Block:Void]
									[Var parsedMsg(34364):Message] [Local _g(34363):Message:Message]
									[Meta:Void]
										:ast(switch (parsedMsg) {
	case TodoCreated(todo):
		trace("Todo created: " + todo.title);	
	case TodoUpdated(todo):
		trace("Todo updated: " + todo.title);	
	case TodoDeleted(id):
		trace("Todo deleted: " + id);	
	case SystemAlert(message):
		trace("Alert: " + message);	
})
										[Switch:Void]
											[Parenthesis:Int]
												[Meta:Int]
													:exhaustive
													[EnumIndex:Int] [Local parsedMsg(34364):Message:Message]
											[Case:Void]
												[Const:Int] 0
												[Block:Void]
													[Var _g(34365):Dynamic]
														[EnumParameter:Dynamic]
															[Local parsedMsg(34364):Message:Message]
															TodoCreated
															0
													[Block:Void]
														[Var todo(34366):Dynamic] [Local _g(34365):Dynamic:Dynamic]
														[Call:Void]
															[Field:(v : Dynamic, ?infos : Null<haxe.PosInfos>) -> Void]
																[TypeExpr haxe.Log:Class<haxe.Log>]
																[FStatic:(v : Dynamic, ?infos : Null<haxe.PosInfos>) -> Void]
																	haxe.Log
																	trace:(v : Dynamic, ?infos : Null<haxe.PosInfos>) -> Void
															[Binop:String]
																[Const:String] "Todo created: "
																+
																[Call:String]
																	[Field:(s : Dynamic) -> String]
																		[TypeExpr Std:Class<Std>]
																		[FStatic:(s : Dynamic) -> String]
																			Std
																			string:(s : Dynamic) -> String
																	[Field:Dynamic]
																		[Local todo(34366):Dynamic:Dynamic]
																		[FDynamic:Dynamic] title
															[ObjectDecl:{ methodName : String, lineNumber : Int, fileName : String, ?customParams : Null<Array<Dynamic>>, className : String }]
																fileName: [Const:String] "Main.hx"
																lineNumber: [Const:Int] 51
																className: [Const:String] "Main"
																methodName: [Const:String] "main"
											[Case:Void]
												[Const:Int] 1
												[Block:Void]
													[Var _g(34367):Dynamic]
														[EnumParameter:Dynamic]
															[Local parsedMsg(34364):Message:Message]
															TodoUpdated
															0
													[Block:Void]
														[Var todo(34368):Dynamic] [Local _g(34367):Dynamic:Dynamic]
														[Call:Void]
															[Field:(v : Dynamic, ?infos : Null<haxe.PosInfos>) -> Void]
																[TypeExpr haxe.Log:Class<haxe.Log>]
																[FStatic:(v : Dynamic, ?infos : Null<haxe.PosInfos>) -> Void]
																	haxe.Log
																	trace:(v : Dynamic, ?infos : Null<haxe.PosInfos>) -> Void
															[Binop:String]
																[Const:String] "Todo updated: "
																+
																[Call:String]
																	[Field:(s : Dynamic) -> String]
																		[TypeExpr Std:Class<Std>]
																		[FStatic:(s : Dynamic) -> String]
																			Std
																			string:(s : Dynamic) -> String
																	[Field:Dynamic]
																		[Local todo(34368):Dynamic:Dynamic]
																		[FDynamic:Dynamic] title
															[ObjectDecl:{ methodName : String, lineNumber : Int, fileName : String, ?customParams : Null<Array<Dynamic>>, className : String }]
																fileName: [Const:String] "Main.hx"
																lineNumber: [Const:Int] 53
																className: [Const:String] "Main"
																methodName: [Const:String] "main"
											[Case:Void]
												[Const:Int] 2
												[Block:Void]
													[Var _g(34369):Int]
														[EnumParameter:Int]
															[Local parsedMsg(34364):Message:Message]
															TodoDeleted
															0
													[Block:Void]
														[Var id(34370):Int] [Local _g(34369):Int:Int]
														[Call:Void]
															[Field:(v : Dynamic, ?infos : Null<haxe.PosInfos>) -> Void]
																[TypeExpr haxe.Log:Class<haxe.Log>]
																[FStatic:(v : Dynamic, ?infos : Null<haxe.PosInfos>) -> Void]
																	haxe.Log
																	trace:(v : Dynamic, ?infos : Null<haxe.PosInfos>) -> Void
															[Binop:String]
																[Const:String] "Todo deleted: "
																+
																[Local id(34370):Int:Int]
															[ObjectDecl:{ methodName : String, lineNumber : Int, fileName : String, ?customParams : Null<Array<Dynamic>>, className : String }]
																fileName: [Const:String] "Main.hx"
																lineNumber: [Const:Int] 55
																className: [Const:String] "Main"
																methodName: [Const:String] "main"
											[Case:Void]
												[Const:Int] 3
												[Block:Void]
													[Var _g(34371):String]
														[EnumParameter:String]
															[Local parsedMsg(34364):Message:Message]
															SystemAlert
															0
													[Block:Void]
														[Var message(34372):String] [Local _g(34371):String:String]
														[Call:Void]
															[Field:(v : Dynamic, ?infos : Null<haxe.PosInfos>) -> Void]
																[TypeExpr haxe.Log:Class<haxe.Log>]
																[FStatic:(v : Dynamic, ?infos : Null<haxe.PosInfos>) -> Void]
																	haxe.Log
																	trace:(v : Dynamic, ?infos : Null<haxe.PosInfos>) -> Void
															[Binop:String]
																[Const:String] "Alert: "
																+
																[Local message(34372):String:String]
															[ObjectDecl:{ methodName : String, lineNumber : Int, fileName : String, ?customParams : Null<Array<Dynamic>>, className : String }]
																fileName: [Const:String] "Main.hx"
																lineNumber: [Const:Int] 57
																className: [Const:String] "Main"
																methodName: [Const:String] "main"
						[Case:Void]
							[Const:Int] 1
							[Call:Void]
								[Field:(v : Dynamic, ?infos : Null<haxe.PosInfos>) -> Void]
									[TypeExpr haxe.Log:Class<haxe.Log>]
									[FStatic:(v : Dynamic, ?infos : Null<haxe.PosInfos>) -> Void]
										haxe.Log
										trace:(v : Dynamic, ?infos : Null<haxe.PosInfos>) -> Void
								[Const:String] "No message parsed"
								[ObjectDecl:{ methodName : String, lineNumber : Int, fileName : String, ?customParams : Null<Array<Dynamic>>, className : String }]
									fileName: [Const:String] "Main.hx"
									lineNumber: [Const:Int] 60
									className: [Const:String] "Main"
									methodName: [Const:String] "main"
}