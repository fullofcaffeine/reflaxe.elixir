class reflaxe.elixir.helpers.UsageDetector {

	public static function isParameterUsed(param:haxe.macro.TVar, body:haxe.macro.TypedExpr) {
		if (body == null) {
			return false;
		};
		var used = [false];
		var checkExpr = [null];
		checkExpr[0] = function(e:haxe.macro.TypedExpr) {
			if (e == null || used[0]) {
				return;
			};
			@:ast(switch (e.expr) {
	case TLocal(v):
		if (v.id == param.id) {
			used = true;
		};	
	default:
		TypedExprTools.iter(e, checkExpr);	
}) {
				var ` = e.expr;
				if (enumIndex ` == 1) {
					var ` = `[0];
					{
						var v = `;
						{
							if (v.id == param.id) {
								used[0] = true;
							};
						};
					};
				} else {
					haxe.macro.TypedExprTools.iter(e, checkExpr[0]);
				};
			};
		};
		checkExpr[0](body);
		return used[0];
	}
}