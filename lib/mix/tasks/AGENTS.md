# Mix Tasks Documentation - DO NOT DELETE THESE FILES

> **âš ï¸ SYNC DIRECTIVE**: This file (`AGENTS.md`) and `CLAUDE.md` in the same directory must be kept in sync. When updating either file, update the other as well.

## âš ï¸ CRITICAL WARNING FOR AI AGENTS

**THESE FILES ARE NOT GENERATED BY HAXE COMPILATION!** They are hand-written Elixir Mix tasks that provide essential development tooling for the Reflaxe.Elixir compiler ecosystem.

**NEVER DELETE ANY FILES IN THIS DIRECTORY!** These were accidentally deleted in commit 31ed49d and had to be restored. They are critical infrastructure.

## ğŸ“ Directory Structure

```
lib/mix/tasks/
â”œâ”€â”€ AGENTS.md                    # THIS FILE - Documentation (DO NOT DELETE)
â”œâ”€â”€ compile.haxe.ex             # Mix compiler integration for Haxeâ†’Elixir
â”œâ”€â”€ haxe.watch.ex               # File watching for auto-recompilation
â”œâ”€â”€ haxe.errors.ex              # Error display and debugging tools
â”œâ”€â”€ haxe.stacktrace.ex          # Stacktrace analysis for debugging
â”œâ”€â”€ haxe.inspect.ex             # Code inspection and analysis tools
â”œâ”€â”€ haxe.source_map.ex          # Source map generation and validation
â”œâ”€â”€ haxe.gen.project.ex         # Generate new Haxeâ†’Elixir projects
â”œâ”€â”€ haxe.gen.schema.ex          # Generate Ecto schemas from Haxe
â”œâ”€â”€ haxe.gen.live.ex            # Generate Phoenix LiveView from Haxe
â”œâ”€â”€ haxe.gen.context.ex         # Generate Phoenix contexts from Haxe
â””â”€â”€ haxe.gen.migration.ex       # Generate Ecto migrations from Haxe
```

## ğŸ”§ Mix Tasks Overview

### Core Compilation Tasks

#### `Mix.Tasks.Compile.Haxe`
**File**: `compile.haxe.ex`
- Integrates Haxe compilation into Mix build pipeline
- Handles automatic compilation when Haxe files change
- Manages compilation cache and incremental builds

#### `Mix.Tasks.Haxe.Watch`
**File**: `haxe.watch.ex`
- Watches Haxe source files for changes
- Triggers automatic recompilation
- Provides hot-reload functionality during development

### Debugging and Analysis Tools

#### `Mix.Tasks.Haxe.Errors`
**File**: `haxe.errors.ex`
- Displays compilation errors in structured formats
- Provides JSON output for LLM agents
- Filters and searches through error history
- Essential for debugging compilation issues

#### `Mix.Tasks.Haxe.Stacktrace`
**File**: `haxe.stacktrace.ex`
- Analyzes stacktraces from compilation errors
- Provides cross-level debugging (Haxeâ†’Elixir mapping)
- Generates debugging recommendations for LLM agents

#### `Mix.Tasks.Haxe.Inspect`
**File**: `haxe.inspect.ex`
- Inspects generated Elixir code
- Maps between Haxe source and Elixir output
- Provides code quality analysis

#### `Mix.Tasks.Haxe.SourceMap`
**File**: `haxe.source_map.ex`
- Generates source maps for debugging
- Validates source map integrity
- Maps runtime errors back to Haxe source

### Code Generation Tasks

#### `Mix.Tasks.Haxe.Gen.Project`
**File**: `haxe.gen.project.ex`
- Scaffolds new Haxeâ†’Elixir projects
- Sets up build configuration
- Creates project structure

#### `Mix.Tasks.Haxe.Gen.Schema`
**File**: `haxe.gen.schema.ex`
- Generates Ecto schemas from Haxe type definitions
- Creates corresponding changesets
- Handles database mappings

#### `Mix.Tasks.Haxe.Gen.Live`
**File**: `haxe.gen.live.ex`
- Generates Phoenix LiveView modules
- Creates mount/handle_event/render functions
- Sets up LiveView routing

#### `Mix.Tasks.Haxe.Gen.Context`
**File**: `haxe.gen.context.ex`
- Generates Phoenix contexts
- Creates CRUD operations
- Sets up business logic layers

#### `Mix.Tasks.Haxe.Gen.Migration`
**File**: `haxe.gen.migration.ex`
- Generates Ecto migrations
- Creates database change scripts
- Handles schema evolution

## ğŸ§ª Testing

These Mix tasks are tested by the Mix integration test suite:
- `test/stacktrace_integration_test.exs` - Tests error and stacktrace tasks
- `test/verify_real_errors_test.exs` - Tests error parsing functionality
- `test/mix_integration_test.exs` - Tests compilation integration

Run tests with:
```bash
MIX_ENV=test mix test
```

## ğŸ¯ Purpose and Importance

These Mix tasks provide essential developer tooling that:

1. **Enables seamless integration** between Haxe and Elixir ecosystems
2. **Provides debugging capabilities** for cross-compilation issues
3. **Supports code generation** for rapid development
4. **Enables LLM agents** to programmatically debug compilation errors
5. **Facilitates project scaffolding** for new applications

## âš ï¸ Historical Context

These files were accidentally deleted in commit `31ed49d` on August 20, 2025, when attempting to fix Y combinator syntax issues. The commit message said "restore critical Mix infrastructure" but actually deleted ~5,200 lines of Mix tooling.

They were restored on August 26, 2025, after discovering tests were failing due to missing modules.

## ğŸš¨ Maintenance Rules

1. **NEVER delete these files** - They are not generated code
2. **Test before modifying** - Run Mix tests to ensure compatibility
3. **Document changes** - Update this file when adding/modifying tasks
4. **Preserve backwards compatibility** - Many tools may depend on these tasks
5. **Keep error handling robust** - These tools are used for debugging

## ğŸ“ Notes for AI Agents

When working with the Reflaxe.Elixir compiler:
- These Mix tasks are **hand-written infrastructure**, not generated output
- They provide essential debugging and development capabilities
- They are tested by the Mix integration test suite
- They should be modified carefully with full testing
- They are NOT created by compiling Haxe code - they are written directly in Elixir

**Remember**: If you see compilation errors mentioning missing Mix.Tasks.Haxe.* modules, check if these files exist first before assuming they need to be created.