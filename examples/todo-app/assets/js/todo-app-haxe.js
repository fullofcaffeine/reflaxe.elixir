// Generated by Haxe 4.3.7
(function ($global) { "use strict";
Math.__name__ = true;
class Std {
	static string(s) {
		return js_Boot.__string_rec(s,"");
	}
}
Std.__name__ = true;
class client_SimpleTodoApp {
	static main() {
		window.addEventListener("DOMContentLoaded",function() {
			client_SimpleTodoApp.setupLiveViewHooks();
			client_SimpleTodoApp.setupGlobalKeyboardShortcuts();
		});
	}
	static createHookFunction(handler) {
		return function() {
			let hook = this;
			handler(hook);
		};
	}
	static setupLiveViewHooks() {
		client_SimpleTodoApp.hooks["TodoDragVisuals"] = { mounted : client_SimpleTodoApp.createHookFunction(function(hook) {
			client_SimpleTodoApp.addDragVisualFeedback(hook.el);
		}), updated : client_SimpleTodoApp.createHookFunction(function(hook) {
			client_SimpleTodoApp.addUpdateFlash(hook.el);
		})};
		client_SimpleTodoApp.hooks["TodoOfflineCache"] = { mounted : client_SimpleTodoApp.createHookFunction(function(hook) {
			client_SimpleTodoApp.loadOfflineIndicator(hook.el);
		}), updated : client_SimpleTodoApp.createHookFunction(function(hook) {
			client_SimpleTodoApp.cacheForOffline(hook.el);
		})};
		client_SimpleTodoApp.hooks["TodoAnimations"] = { mounted : client_SimpleTodoApp.createHookFunction(function(hook) {
			client_SimpleTodoApp.setupKeyboardShortcuts(hook);
		})};
	}
	static addDragVisualFeedback(container) {
		let items = container.querySelectorAll(".todo-item");
		let _g = 0;
		let _g1 = items.length;
		while(_g < _g1) {
			let item = js_Boot.__cast(items[_g++] , HTMLElement);
			item.addEventListener("mousedown",function(e) {
				(js_Boot.__cast(e.target , HTMLElement)).classList.add("grabbing");
			});
			item.addEventListener("mouseup",function(e) {
				(js_Boot.__cast(e.target , HTMLElement)).classList.remove("grabbing");
			});
			item.addEventListener("mouseenter",function(e) {
				(js_Boot.__cast(e.target , HTMLElement)).classList.add("haxe-hover");
			});
			item.addEventListener("mouseleave",function(e) {
				(js_Boot.__cast(e.target , HTMLElement)).classList.remove("haxe-hover");
			});
		}
	}
	static addUpdateFlash(element) {
		element.classList.add("updated-flash");
		window.setTimeout(function() {
			element.classList.remove("updated-flash");
		},200);
	}
	static loadOfflineIndicator(element) {
		let cached = js_Browser.getLocalStorage().getItem("todos_cache");
		if(cached != null) {
			element.classList.add("has-offline-cache");
		}
	}
	static cacheForOffline(element) {
		let storage = js_Browser.getLocalStorage();
		let todosData = element.dataset.todos;
		if(todosData != null) {
			storage.setItem("todos_cache",todosData);
			storage.setItem("todos_cache_time",Std.string(new Date().getTime()));
		}
	}
	static setupKeyboardShortcuts(hook) {
		hook.el.addEventListener("keydown",function(e) {
			if((e.ctrlKey || e.metaKey) && e.key == "Enter") {
				e.preventDefault();
				hook.pushEvent("toggle_todo",{ });
			}
			if(e.key == "Delete") {
				e.preventDefault();
				hook.pushEvent("delete_todo",{ });
			}
			if(e.key == "Escape") {
				e.preventDefault();
				hook.pushEvent("cancel_edit",{ });
			}
		});
	}
	static setupGlobalKeyboardShortcuts() {
		window.document.addEventListener("keydown",function(e) {
			if((e.ctrlKey || e.metaKey) && e.key == "n") {
				e.preventDefault();
				client_SimpleTodoApp.pushGlobalEvent("new_todo",{ });
			}
			if((e.ctrlKey || e.metaKey) && e.key == "f") {
				e.preventDefault();
				let searchInput = window.document.querySelector(".search-input");
				if(searchInput != null) {
					searchInput.focus();
				}
			}
			if(e.altKey) {
				switch(e.key) {
				case "a":
					client_SimpleTodoApp.pushGlobalEvent("filter_todos",{ filter : "all"});
					break;
				case "c":
					client_SimpleTodoApp.pushGlobalEvent("filter_todos",{ filter : "completed"});
					break;
				case "p":
					client_SimpleTodoApp.pushGlobalEvent("filter_todos",{ filter : "pending"});
					break;
				}
			}
		});
	}
	static pushGlobalEvent(event,payload) {
		if(client_SimpleTodoApp.liveSocket != null) {
			client_SimpleTodoApp.liveSocket.pushEvent(event,payload);
		}
	}
}
client_SimpleTodoApp.__name__ = true;
class haxe_Exception extends Error {
	constructor(message,previous,native) {
		super(message);
		this.message = message;
		this.__previousException = previous;
		this.__nativeException = native != null ? native : this;
	}
	get_native() {
		return this.__nativeException;
	}
	static thrown(value) {
		if(((value) instanceof haxe_Exception)) {
			return value.get_native();
		} else if(((value) instanceof Error)) {
			return value;
		} else {
			let e = new haxe_ValueException(value);
			return e;
		}
	}
}
haxe_Exception.__name__ = true;
haxe_Exception.__super__ = Error;
Object.assign(haxe_Exception.prototype, {
	__class__: haxe_Exception
});
class haxe_ValueException extends haxe_Exception {
	constructor(value,previous,native) {
		super(String(value),previous,native);
		this.value = value;
	}
}
haxe_ValueException.__name__ = true;
haxe_ValueException.__super__ = haxe_Exception;
Object.assign(haxe_ValueException.prototype, {
	__class__: haxe_ValueException
});
class haxe_iterators_ArrayIterator {
	constructor(array) {
		this.current = 0;
		this.array = array;
	}
	hasNext() {
		return this.current < this.array.length;
	}
	next() {
		return this.array[this.current++];
	}
}
haxe_iterators_ArrayIterator.__name__ = true;
Object.assign(haxe_iterators_ArrayIterator.prototype, {
	__class__: haxe_iterators_ArrayIterator
});
class js_Boot {
	static getClass(o) {
		if(o == null) {
			return null;
		} else if(((o) instanceof Array)) {
			return Array;
		} else {
			let cl = o.__class__;
			if(cl != null) {
				return cl;
			}
			let name = js_Boot.__nativeClassName(o);
			if(name != null) {
				return js_Boot.__resolveNativeClass(name);
			}
			return null;
		}
	}
	static __string_rec(o,s) {
		if(o == null) {
			return "null";
		}
		if(s.length >= 5) {
			return "<...>";
		}
		let t = typeof(o);
		if(t == "function" && (o.__name__ || o.__ename__)) {
			t = "object";
		}
		switch(t) {
		case "function":
			return "<function>";
		case "object":
			if(((o) instanceof Array)) {
				let str = "[";
				s += "\t";
				let _g = 0;
				let _g1 = o.length;
				while(_g < _g1) {
					let i = _g++;
					str += (i > 0 ? "," : "") + js_Boot.__string_rec(o[i],s);
				}
				str += "]";
				return str;
			}
			let tostr;
			try {
				tostr = o.toString;
			} catch( _g ) {
				return "???";
			}
			if(tostr != null && tostr != Object.toString && typeof(tostr) == "function") {
				let s2 = o.toString();
				if(s2 != "[object Object]") {
					return s2;
				}
			}
			let str = "{\n";
			s += "\t";
			let hasp = o.hasOwnProperty != null;
			let k = null;
			for( k in o ) {
			if(hasp && !o.hasOwnProperty(k)) {
				continue;
			}
			if(k == "prototype" || k == "__class__" || k == "__super__" || k == "__interfaces__" || k == "__properties__") {
				continue;
			}
			if(str.length != 2) {
				str += ", \n";
			}
			str += s + k + " : " + js_Boot.__string_rec(o[k],s);
			}
			s = s.substring(1);
			str += "\n" + s + "}";
			return str;
		case "string":
			return o;
		default:
			return String(o);
		}
	}
	static __interfLoop(cc,cl) {
		while(true) {
			if(cc == null) {
				return false;
			}
			if(cc == cl) {
				return true;
			}
			let intf = cc.__interfaces__;
			if(intf != null && (cc.__super__ == null || cc.__super__.__interfaces__ != intf)) {
				let _g = 0;
				let _g1 = intf.length;
				while(_g < _g1) {
					let i = intf[_g++];
					if(i == cl || js_Boot.__interfLoop(i,cl)) {
						return true;
					}
				}
			}
			cc = cc.__super__;
		}
	}
	static __instanceof(o,cl) {
		if(cl == null) {
			return false;
		}
		switch(cl) {
		case Array:
			return ((o) instanceof Array);
		case Bool:
			return typeof(o) == "boolean";
		case Dynamic:
			return o != null;
		case Float:
			return typeof(o) == "number";
		case Int:
			if(typeof(o) == "number") {
				return ((o | 0) === o);
			} else {
				return false;
			}
			break;
		case String:
			return typeof(o) == "string";
		default:
			if(o != null) {
				if(typeof(cl) == "function") {
					if(js_Boot.__downcastCheck(o,cl)) {
						return true;
					}
				} else if(typeof(cl) == "object" && js_Boot.__isNativeObj(cl)) {
					if(((o) instanceof cl)) {
						return true;
					}
				}
			} else {
				return false;
			}
			if(cl == Class ? o.__name__ != null : false) {
				return true;
			}
			if(cl == Enum ? o.__ename__ != null : false) {
				return true;
			}
			return false;
		}
	}
	static __downcastCheck(o,cl) {
		if(!((o) instanceof cl)) {
			if(cl.__isInterface__) {
				return js_Boot.__interfLoop(js_Boot.getClass(o),cl);
			} else {
				return false;
			}
		} else {
			return true;
		}
	}
	static __cast(o,t) {
		if(o == null || js_Boot.__instanceof(o,t)) {
			return o;
		} else {
			throw haxe_Exception.thrown("Cannot cast " + Std.string(o) + " to " + Std.string(t));
		}
	}
	static __nativeClassName(o) {
		let name = js_Boot.__toStr.call(o).slice(8,-1);
		if(name == "Object" || name == "Function" || name == "Math" || name == "JSON") {
			return null;
		}
		return name;
	}
	static __isNativeObj(o) {
		return js_Boot.__nativeClassName(o) != null;
	}
	static __resolveNativeClass(name) {
		return $global[name];
	}
}
js_Boot.__name__ = true;
class js_Browser {
	static getLocalStorage() {
		try {
			let s = window.localStorage;
			s.getItem("");
			if(s.length == 0) {
				let key = "_hx_" + Math.random();
				s.setItem(key,key);
				s.removeItem(key);
			}
			return s;
		} catch( _g ) {
			return null;
		}
	}
}
js_Browser.__name__ = true;
{
	Object.defineProperty(String.prototype,"__class__",{ value : String, enumerable : false, writable : true});
	String.__name__ = true;
	Array.__name__ = true;
	Date.prototype.__class__ = Date;
	Date.__name__ = "Date";
	var Int = { };
	var Dynamic = { };
	var Float = Number;
	var Bool = Boolean;
	var Class = { };
	var Enum = { };
}
js_Boot.__toStr = ({ }).toString;
client_SimpleTodoApp.hooks = { };
client_SimpleTodoApp.main();
})(typeof window != "undefined" ? window : typeof global != "undefined" ? global : typeof self != "undefined" ? self : this);
