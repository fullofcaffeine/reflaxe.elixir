// Generated by Haxe 4.3.7
(function ($global) { "use strict";
var Reflect = function() { };
Reflect.field = function(o,field) {
	try {
		return o[field];
	} catch( _g ) {
		return null;
	}
};
Reflect.deleteField = function(o,field) {
	if(!Object.prototype.hasOwnProperty.call(o,field)) {
		return false;
	}
	delete(o[field]);
	return true;
};
var client_Boot = function() { };
client_Boot.buildHooks = function() {
	var hooks = { };
	hooks["AutoFocus"] = { mounted : function() {
		client_hooks_AutoFocusHook.mounted(this);
	}};
	hooks["Ping"] = { mounted : function() {
		client_hooks_PingHook.mounted(this);
	}};
	hooks["CopyToClipboard"] = { mounted : function() {
		client_hooks_CopyToClipboardHook.mounted(this);
	}};
	hooks["ThemeToggle"] = { mounted : function() {
		client_hooks_ThemeToggleHook.mounted(this);
	}, destroyed : function() {
		client_hooks_ThemeToggleHook.destroyed(this);
	}};
	return hooks;
};
client_Boot.main = function() {
	client_utils_Theme.applyStoredOrDefault();
	var hooks = client_Boot.buildHooks();
	window.Hooks = Object.assign(window.Hooks || {}, hooks);
};
var client_hooks_AutoFocusHook = function() { };
client_hooks_AutoFocusHook.mounted = function(hook) {
	try {
		hook.el.focus();
	} catch( _g ) {
	}
};
var client_hooks_CopyToClipboardHook = function() { };
client_hooks_CopyToClipboardHook.mounted = function(hook) {
	var el = hook.el;
	el.addEventListener("click",function(_) {
		var text = el.getAttribute("data-copy-text");
		if(text == null || text == "") {
			return;
		}
		client_hooks_CopyToClipboardHook.copyText(text,function(_success) {
			var eventName = el.getAttribute("data-copied-event");
			if(eventName == null || eventName == "") {
				eventName = "clipboard_copied";
			}
			var message = el.getAttribute("data-copied-message");
			if(message == null || message == "") {
				message = "Copied.";
			}
			try {
				if(hook.pushEvent != null) {
					hook.pushEvent(eventName,{ message : message});
				}
			} catch( _g ) {
			}
			el.classList.add("copied");
			window.setTimeout(function() {
				el.classList.remove("copied");
			},800);
		});
	});
};
client_hooks_CopyToClipboardHook.copyText = function(text,done) {
	var clipboard = $global.navigator.clipboard;
	if(clipboard != null && Object.prototype.hasOwnProperty.call(clipboard,"writeText")) {
		try {
			var promise = clipboard.writeText(text);
			promise.then(function(_) {
				done(true);
				return null;
			}).catch(function(_) {
				client_hooks_CopyToClipboardHook.fallbackCopy(text,done);
				return null;
			});
			return;
		} catch( _g ) {
		}
	}
	client_hooks_CopyToClipboardHook.fallbackCopy(text,done);
};
client_hooks_CopyToClipboardHook.fallbackCopy = function(text,done) {
	var tmp = window.document.createElement("textarea");
	tmp.value = text;
	tmp.setAttribute("readonly","");
	tmp.style.position = "absolute";
	tmp.style.left = "-9999px";
	window.document.body.appendChild(tmp);
	tmp.select();
	var ok = false;
	try {
		ok = window.document.execCommand("copy");
	} catch( _g ) {
	}
	try {
		tmp.remove();
	} catch( _g ) {
		if(tmp.parentNode != null) {
			tmp.parentNode.removeChild(tmp);
		}
	}
	done(ok);
};
var client_hooks_PingHook = function() { };
client_hooks_PingHook.mounted = function(hook) {
	try {
		if(hook.pushEvent != null) {
			hook.pushEvent("ping",{ });
		}
	} catch( _g ) {
	}
};
var client_hooks_ThemeToggleHook = function() { };
client_hooks_ThemeToggleHook.labelFor = function(preference) {
	switch(preference) {
	case "dark":
		return "Dark";
	case "light":
		return "Light";
	case "system":
		return "System";
	}
};
client_hooks_ThemeToggleHook.updateLabel = function(root,preference) {
	root.setAttribute("data-theme-mode",preference);
	var label = root.querySelector("[data-theme-label]");
	if(label != null) {
		label.textContent = client_hooks_ThemeToggleHook.labelFor(preference);
	}
};
client_hooks_ThemeToggleHook.mounted = function(ctx) {
	client_hooks_ThemeToggleHook.unbindClick(ctx);
	var preference = client_utils_Theme.applyStoredOrDefault();
	client_hooks_ThemeToggleHook.updateLabel(ctx.el,preference);
	var handler = function(_event) {
		var nextPreference = client_utils_Theme.cycle(client_utils_Theme.getStoredOrDefault());
		client_utils_Theme.store(nextPreference);
		client_utils_Theme.apply(nextPreference);
		client_hooks_ThemeToggleHook.updateLabel(ctx.el,nextPreference);
	};
	ctx.el["__todoappThemeToggleOnClick"] = handler;
	ctx.el.addEventListener("click",handler);
};
client_hooks_ThemeToggleHook.destroyed = function(ctx) {
	client_hooks_ThemeToggleHook.unbindClick(ctx);
};
client_hooks_ThemeToggleHook.unbindClick = function(ctx) {
	var elementDynamic = ctx.el;
	if(!Object.prototype.hasOwnProperty.call(elementDynamic,"__todoappThemeToggleOnClick")) {
		return;
	}
	var existingHandler = Reflect.field(elementDynamic,"__todoappThemeToggleOnClick");
	if(existingHandler != null) {
		ctx.el.removeEventListener("click",existingHandler);
	}
	Reflect.deleteField(elementDynamic,"__todoappThemeToggleOnClick");
};
var client_utils_Theme = function() { };
client_utils_Theme.getMediaQuery = function() {
	if(window != null) {
		return window.matchMedia("(prefers-color-scheme: dark)");
	} else {
		return null;
	}
};
client_utils_Theme.prefersDark = function() {
	var media = client_utils_Theme.getMediaQuery();
	if(media != null) {
		return media.matches;
	} else {
		return false;
	}
};
client_utils_Theme.getStored = function() {
	try {
		var storage = window != null ? window.localStorage : null;
		if(storage == null) {
			return null;
		}
		return client_utils_ThemePreference.parse(storage.getItem("todo_app_theme"));
	} catch( _g ) {
		return null;
	}
};
client_utils_Theme.getStoredOrDefault = function() {
	var tmp = client_utils_Theme.getStored();
	if(tmp != null) {
		return tmp;
	} else {
		return "system";
	}
};
client_utils_Theme.store = function(preference) {
	try {
		var storage = window != null ? window.localStorage : null;
		if(storage == null) {
			return;
		}
		storage.setItem("todo_app_theme",preference);
	} catch( _g ) {
	}
};
client_utils_Theme.apply = function(preference) {
	var root = window.document != null ? window.document.documentElement : null;
	if(root == null) {
		return;
	}
	var dark;
	switch(preference) {
	case "dark":
		dark = true;
		break;
	case "light":
		dark = false;
		break;
	case "system":
		dark = client_utils_Theme.prefersDark();
		break;
	}
	if(dark) {
		root.classList.add("dark");
	} else {
		root.classList.remove("dark");
	}
	root.setAttribute("data-theme",preference);
};
client_utils_Theme.applyStoredOrDefault = function() {
	var preference = client_utils_Theme.getStoredOrDefault();
	client_utils_Theme.apply(preference);
	return preference;
};
client_utils_Theme.cycle = function(preference) {
	switch(preference) {
	case "dark":
		return "system";
	case "light":
		return "dark";
	case "system":
		return "light";
	}
};
var client_utils_ThemePreference = {};
client_utils_ThemePreference.parse = function(value) {
	if(value == null) {
		return null;
	} else {
		switch(value) {
		case "dark":
			return "dark";
		case "light":
			return "light";
		case "system":
			return "system";
		default:
			return null;
		}
	}
};
var haxe_iterators_ArrayIterator = function(array) {
	this.current = 0;
	this.array = array;
};
haxe_iterators_ArrayIterator.prototype = {
	hasNext: function() {
		return this.current < this.array.length;
	}
	,next: function() {
		return this.array[this.current++];
	}
};
client_Boot.main();
})(typeof window != "undefined" ? window : typeof global != "undefined" ? global : typeof self != "undefined" ? self : this);
