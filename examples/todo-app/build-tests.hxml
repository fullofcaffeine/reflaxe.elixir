# Haxeâ†’Elixir compilation for ExUnit tests (MIX_ENV=test)

# Include Reflaxe.Elixir compiler sources and stdlib overlays/externs
 -cp ../../src
 -cp ../../std
 -lib reflaxe

# Test sources only (avoid compiling app/server code into test output)
-cp src_haxe/test

# Output directory for generated test modules (isolated)
-D elixir_output=test/generated

# Required flags
-D reflaxe_runtime
-D no-utf16
-D app_name=TodoApp
-dce full

# Avoid re-emitting runtime std modules already compiled in the app build
--macro exclude('haxe.iterators.ArrayIterator')
--macro exclude('StringBuf')

# Initialize compiler
-D reflaxe.elixir=0.1.0
--macro reflaxe.elixir.CompilerInit.Start()

# Include test modules (explicit for now; add more as needed)
web.HealthTest
web.TodoLiveCrudTest
live.TodoLiveDueDateTest
