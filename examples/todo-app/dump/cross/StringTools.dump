@:keep @:directlyUsed @:used
class StringTools {

	public static function isSpace(s:String, pos:Int) {
		var c = {
			var result = __elixir__(":binary.at({0}, {1})", s, pos);
			__elixir__("if {0} == nil, do: nil, else: {0}", result);
		};
		return c > 8 && c < 14 || c == 32;
	}

	public static function ltrim(s:String) {
		var l = s.length;
		var r = 0;
		while ((r < l && StringTools.isSpace(s, r))) r ++;
		if ((r > 0)) return {
			var len = l - r;
			if ((len == null)) __elixir__("String.slice({0}, {1}..-1)", s, r) else __elixir__("String.slice({0}, {1}, {2})", s, r, len);
		} else return s;
	}

	public static function rtrim(s:String) {
		var l = s.length;
		var r = 0;
		while ((r < l && StringTools.isSpace(s, l - r - 1))) r ++;
		if ((r > 0)) return {
			var len = l - r;
			if ((len == null)) __elixir__("String.slice({0}, {1}..-1)", s, 0) else __elixir__("String.slice({0}, {1}, {2})", s, 0, len);
		} else return s;
	}

	public static function hex(n:Int, digits:Null<Int> = null) {
		var s = "";
		var hexChars = "0123456789ABCDEF";
		do ({
			s = __elixir__("String.at({0}, {1}) || \"\"", hexChars, n & 15) + s;
			n >>>= 4;
		}) while((n > 0));
		if ((digits != null)) while ((s.length < digits)) s = "0" + s;
		return s;
	}
}